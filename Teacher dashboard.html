<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NeuroGrade - Teacher Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    display: flex;
    background: #f8f9fa;
    height: 100vh;
    color: #333;
    overflow: hidden;
  }

  /* Top left logo */
  .top-left-logo {
    position: absolute;
    top: -35px;
    left: -10px;
    height: 200px;
    z-index: 1000;
  }

  /* Sidebar */
  .sidebar {
    width: 200px;
    height: 100vh;
    background: #fff;
    padding: 20px;
    border-right: 1px solid #ddd;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    box-shadow: 2px 0 8px rgba(0,0,0,0.08);
    border-radius: 0 12px 12px 0;
    transition: all 0.3s ease;
  }

  .nav {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 100%;
  }

  .nav a {
    text-decoration: none;
    width: 100%;
  }

  .nav button {
    background: none;
    border: 1px solid rgba(0,0,0,0.08);
    font-size: 16px;
    padding: 12px 15px;
    text-align: left;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.3s ease;
    color: #333;
    width: 100%;
    display: flex;
    align-items: center;
    gap: 15px;
    position: relative;
    overflow: hidden;
  }

  .nav button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .nav button:hover::before {
    left: 100%;
  }

  .nav button.active {
    background: #8e44ad;
    color: #fff;
    font-weight: bold;
    border-color: #6c3483;
    transform: translateX(5px);
    box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
  }

  .nav button:hover {
    background: #f0e6f5;
    color: #8e44ad;
    border-color: #8e44ad;
    transform: translateX(3px);
  }

  .nav button i {
    transition: transform 0.3s ease;
  }

  .nav button:hover i {
    transform: scale(1.2);
  }

  .nav button.active i {
    transform: scale(1.2);
    color: #fff;
  }

  /* Main content */
  .main {
    flex: 1;
    padding: 20px;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    margin-top: 70px;
    background: #f8f9fa;
    transition: all 0.3s ease;
  }

  /* Top bar */
  .top-bar {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
    padding: 15px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    border: 1px solid rgba(0,0,0,0.05);
  }

  .icon-link {
    position: relative;
    text-decoration: none;
    color: #8e44ad;
    font-size: 20px;
    transition: transform 0.3s, color 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #f0e6f5;
    margin-top: -10px;
    border: 1px solid rgba(142, 68, 173, 0.2);
  }

  .icon-link:hover {
    transform: scale(1.2) rotate(5deg);
    color: #ff6b6b;
    background: #ffe9e9;
    border-color: rgba(255, 107, 107, 0.3);
  }

  .icon-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #ff6b6b;
    color: white;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    font-size: 11px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    border: 1px solid #fff;
    animation: pulse 1.5s infinite;
  }

  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }

  .top-user {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    padding: 8px 15px;
    background: #f8f9fa;
    border-radius: 20px;
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }

  .top-user:hover {
    background: #f0e6f5;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .top-user img {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    object-fit: cover;
    transition: all 0.3s ease;
  }

  .top-user:hover img {
    transform: scale(1.1);
    border: 2px solid #8e44ad;
  }

  /* Welcome banner */
  .welcome-box {
    background: linear-gradient(to right, #8e44ad, #b57dff);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 4px 10px rgba(142, 68, 173, 0.3);
    animation: fadeIn 0.5s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .welcome-box h1 {
    font-size: 24px;
    margin-bottom: 5px;
  }

  .welcome-box p {
    font-size: 14px;
    opacity: 0.9;
  }

  /* Dashboard layout */
  .dashboard {
    display: flex;
    gap: 20px;
    animation: fadeIn 0.7s ease;
  }

  /* Left column */
  .left-col {
    flex: 1;
  }

  .average-card {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }

  .average-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .average-card h2 {
    font-size: 16px;
    margin-bottom: 5px;
    color: #555;
  }

  .average-card .average {
    font-size: 32px;
    font-weight: bold;
    color: #8e44ad;
    margin: 10px 0;
    transition: all 0.3s ease;
  }

  .average-card .change {
    font-size: 14px;
    color: #28a745;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .average-card .students-count {
    font-size: 13px;
    color: #666;
    margin-top: 10px;
  }

  /* Subjects card */
  .subjects-card {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }

  .subjects-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .subjects-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
  }

  .subjects-header h2 {
    color: #333;
    margin: 0;
  }

  .add-subject-btn {
    background: #8e44ad;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .add-subject-btn:hover {
    background: #793a9c;
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .subject-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #f5f5f5;
    transition: all 0.3s ease;
  }

  .subject-item:hover {
    background: #f8f9fa;
    padding-left: 10px;
    border-radius: 6px;
  }

  .subject-item:last-child {
    border-bottom: none;
  }

  .subject-info h3 {
    font-size: 16px;
    margin-bottom: 5px;
    color: #333;
  }

  .subject-info p {
    font-size: 13px;
    color: #666;
    margin-bottom: 0;
  }

  .subject-actions {
    display: flex;
    gap: 10px;
  }

  .subject-item button {
    background: #8e44ad;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .subject-item button.edit-btn {
    background: #6c757d;
  }

  .subject-item button:hover {
    opacity: 0.9;
    transform: scale(1.05);
  }

  /* Right column */
  .right-col {
    flex: 2;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }

  .right-col:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .right-col h2 {
    margin-bottom: 5px;
    color: #333;
  }

  .right-col > p {
    color: #666;
    margin-bottom: 20px;
    font-size: 14px;
  }

  .graph-container {
    min-height: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px dashed #ddd;
    border-radius: 8px;
    background: #fafafa;
    color: #888;
    transition: all 0.3s ease;
  }

  .graph-container:hover {
    border-color: #8e44ad;
    background: #f0e6f5;
  }

  /* Page content containers */
  .page-content {
    display: none;
    flex: 1;
    flex-direction: column;
    gap: 20px;
  }

  .page-content.active {
    display: flex;
  }

  /* Feedback page layout */
  .feedback-layout {
    display: flex;
    gap: 20px;
    flex: 1;
    margin-top: 20px;
    height: calc(100vh - 180px);
  }

  /* Student list */
  .student-list {
    width: 300px;
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    gap: 10px;
    border: 1px solid rgba(0,0,0,0.08);
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .student-list:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .student-search input {
    width: 100%;
    padding: 12px 15px;
    font-size: 14px;
    border: 1px solid #ddd;
    border-radius: 8px;
    transition: all 0.3s;
    background: #f8f9fa;
    margin-bottom: 10px;
  }
  
  .student-search input:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 8px rgba(142, 68, 173, 0.4);
    background: #fff;
  }
  
  .student-search input::placeholder {
    color: #aaa;
  }

  .students {
    flex: 1;
    overflow-y: auto;
    padding-right: 5px;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 8px;
    background: #f8f9fa;
    padding: 10px;
  }

  .students::-webkit-scrollbar {
    width: 6px;
  }

  .students::-webkit-scrollbar-thumb {
    background: #ddd;
    border-radius: 3px;
  }
  
  .student-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 12px 15px;
    font-size: 14px;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s;
    border: 1px solid transparent;
    margin-bottom: 8px;
    background: #fff;
    position: relative;
    overflow: hidden;
  }

  .student-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .student-item:hover::before {
    left: 100%;
  }

  .student-item:hover {
    background: #f0e6f5;
    color: #8e44ad;
    border-color: #8e44ad;
    transform: translateX(3px);
  }

  .student-item.active {
    background: #8e44ad;
    color: white;
    font-weight: bold;
    border-color: #6c3483;
    transform: translateX(5px);
    box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
  }
  
  .student-item img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #f0e6f5;
    border: 1px solid #ddd;
    transition: all 0.3s ease;
  }

  .student-item:hover img {
    transform: scale(1.1);
    border-color: #8e44ad;
  }
  
  .student-info {
    flex: 1;
  }
  
  .student-info h4 {
    font-size: 15px;
  }
  
  .student-info small {
    display: block;
    font-size: 12px;
    color: #666;
  }

  .student-item.active .student-info small {
    color: #f0e6f5;
  }

  /* Student profile section */
  .student-profile-section {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 20px;
    transition: all 0.3s ease;
  }

  .student-profile-section:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }
  
  .student-profile-section img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid #8e44ad;
    transition: all 0.3s ease;
  }

  .student-profile-section:hover img {
    transform: scale(1.1);
    border-color: #6c3483;
  }
  
  .student-profile-info {
    line-height: 1.4;
    flex: 1;
  }
  
  .student-profile-info h2 {
    font-size: 24px;
    font-weight: 600;
    color: #333;
    margin-bottom: 5px;
    transition: all 0.3s ease;
  }

  .student-profile-section:hover .student-profile-info h2 {
    color: #8e44ad;
  }
  
  .student-profile-info .student-number {
    color: #777;
    font-size: 16px;
    transition: all 0.3s ease;
  }

  .student-profile-section:hover .student-profile-info .student-number {
    color: #8e44ad;
  }

  /* Right panel container */
  .right-panel-container {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  /* Right panel */
  .feedback-panel {
    flex: 1;
    display: grid;
    grid-template-columns: 2fr 1.5fr 1fr;
    gap: 20px;
    height: 100%;
    align-items: start;
  }

  .panel-card {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    border-left: 5px solid #8e44ad;
    height: 100%;
    transition: all 0.3s ease;
  }

  .panel-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }
  
  .panel-card:nth-child(1) {
    border-left-color: #8e44ad;
  }
  
  .panel-card:nth-child(2) {
    border-left-color: #8e44ad;
  }
  
  .panel-card:nth-child(3) {
    border-left-color: #8e44ad;
  }
  
  .panel-card h3 {
    font-size: 18px;
    color: #555;
    margin-bottom: 15px;
    border-bottom: 2px solid #eee;
    padding-bottom: 10px;
    font-weight: 500;
    flex-shrink: 0;
    transition: all 0.3s ease;
  }

  .panel-card:hover h3 {
    color: #8e44ad;
    border-bottom-color: #8e44ad;
  }
  
  .panel-card h3 i {
    color: #8e44ad;
    margin-right: 10px;
    transition: all 0.3s ease;
  }

  .panel-card:hover h3 i {
    transform: scale(1.2);
  }
  
  .panel-card:nth-child(1) h3 i {
    color: #8e44ad;
  }
  
  .panel-card:nth-child(2) h3 i {
    color: #8e44ad;
  }
  
  .panel-card:nth-child(3) h3 i {
    color: #8e44ad;
  }
  
  .task-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    flex: 1;
    overflow-y: auto;
  }
  
  .task-item {
    background: #f8f9fa;
    padding: 12px 15px;
    border-radius: 8px;
    border: 1px solid #e9ecef;
    transition: all 0.3s ease;
    cursor: pointer;
    flex-shrink: 0;
    position: relative;
    overflow: hidden;
  }

  .task-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .task-item:hover::before {
    left: 100%;
  }
  
  .task-item:hover {
    background: #f0e6f5;
    color: #8e44ad;
    border-color: #8e44ad;
    transform: translateX(3px);
  }
  
  .task-item.active {
    background: #8e44ad;
    color: white;
    border-color: #6c3483;
    font-weight: bold;
    transform: translateX(5px);
    box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
  }
  
  .autograder-results {
    display: flex;
    flex-direction: column;
    gap: 15px;
    flex: 1;
    overflow-y: auto;
  }
  
  .result-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
    flex-shrink: 0;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .result-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .result-item:hover::before {
    left: 100%;
  }
  
  .result-item:hover {
    background: #f0e6f5;
    border-color: #8e44ad;
    transform: translateX(3px);
  }
  
  .result-item i.fa-check-circle {
    color: #2e7d32;
    font-size: 20px;
    transition: all 0.3s ease;
  }

  .result-item:hover i.fa-check-circle {
    transform: scale(1.2);
  }
  
  .result-item i.fa-xmark-circle {
    color: #c62828;
    font-size: 20px;
    transition: all 0.3s ease;
  }

  .result-item:hover i.fa-xmark-circle {
    transform: scale(1.2);
  }
  
  .result-item span {
    flex: 1;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
  }

  .result-item:hover span {
    color: #8e44ad;
  }
  
  .result-item small {
    font-size: 13px;
    color: #777;
    font-weight: normal;
    transition: all 0.3s ease;
  }

  .result-item:hover small {
    color: #8e44ad;
  }
  
  .manual-feedback {
    display: flex;
    flex-direction: column;
    gap: 15px;
    flex: 1;
    height: 100%;
  }
  
  .feedback-textarea {
    width: 100%;
    height: 100px;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 12px;
    font-size: 14px;
    resize: vertical;
    transition: all 0.3s ease;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin-bottom: 10px;
  }
  
  .feedback-textarea:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 8px rgba(142, 68, 173, 0.3);
    transform: translateY(-2px);
  }
  
  .feedback-textarea::placeholder {
    color: #aaa;
  }
  
  .grade-input-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    background: #f0e6f5;
    padding: 20px;
    border-radius: 12px;
    border: 1px solid #8e44ad;
    margin-top: auto;
    flex-shrink: 0;
    transition: all 0.3s ease;
  }

  .grade-input-container:hover {
    background: #e6d9f0;
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(142, 68, 173, 0.2);
  }
  
  .grade-input-container h4 {
    font-size: 14px;
    font-weight: normal;
    color: #555;
    margin-bottom: 10px;
    transition: all 0.3s ease;
  }

  .grade-input-container:hover h4 {
    color: #8e44ad;
  }
  
  .grade-input-wrapper {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .grade-input {
    width: 60px;
    padding: 8px;
    font-size: 20px;
    font-weight: bold;
    text-align: center;
    border: 2px solid #8e44ad;
    border-radius: 8px;
    color: #8e44ad;
    transition: all 0.3s ease;
  }
  
  .grade-input:focus {
    outline: none;
    border-color: #6c3483;
    box-shadow: 0 0 8px rgba(108, 52, 131, 0.5);
    transform: scale(1.05);
  }
  
  .grade-slash {
    font-size: 24px;
    font-weight: bold;
    color: #8e44ad;
    transition: all 0.3s ease;
  }

  .grade-input-container:hover .grade-slash {
    transform: scale(1.1);
  }
  
  .grade-total {
    font-size: 20px;
    font-weight: bold;
    color: #8e44ad;
    transition: all 0.3s ease;
  }

  .grade-input-container:hover .grade-total {
    transform: scale(1.1);
  }
  
  .save-button {
    width: 100%;
    padding: 12px;
    background: #8e44ad;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 20px;
    flex-shrink: 0;
    position: relative;
    overflow: hidden;
  }

  .save-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .save-button:hover::before {
    left: 100%;
  }
  
  .save-button:hover {
    background: #6c3483;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(108, 52, 131, 0.3);
  }
  
  .save-button:disabled {
    background: #cccccc;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }
  
  .save-button.saved {
    background: #2e7d32;
  }

  .save-button.saved:hover {
    background: #1b5e20;
  }
  
  .flex-spacer {
    flex: 1;
  }
  
  .feedback-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }
  
  .feedback-header b {
    font-size: 14px;
    color: #555;
    transition: all 0.3s ease;
  }

  .feedback-textarea:focus + .feedback-header b {
    color: #8e44ad;
  }
  
  /* Loading indicator - FIXED */
  .loading {
    text-align: center;
    padding: 40px 20px;
    color: #8e44ad;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    flex: 1;
    transition: all 0.3s ease;
  }

  .loading:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .loading i {
    font-size: 32px;
    margin-bottom: 15px;
    animation: spin 1.5s linear infinite;
    transition: all 0.3s ease;
  }

  .loading:hover i {
    color: #8e44ad;
    transform: scale(1.2);
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Practice page layout */
  .practice-layout {
    display: flex;
    gap: 20px;
    flex: 1;
    margin-top: 20px;
    height: calc(100vh - 180px);
  }

  /* Test list */
  .test-list {
    width: 300px;
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    gap: 10px;
    border: 1px solid rgba(0,0,0,0.08);
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .test-list:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .test-search input {
    width: 100%;
    padding: 12px 15px;
    font-size: 14px;
    border: 1px solid #ddd;
    border-radius: 8px;
    transition: all 0.3s;
    background: #f8f9fa;
    margin-bottom: 10px;
  }
  
  .test-search input:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 8px rgba(142, 68, 173, 0.4);
    background: #fff;
  }
  
  .test-search input::placeholder {
    color: #aaa;
  }

  .tests {
    flex: 1;
    overflow-y: auto;
    padding-right: 5px;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 8px;
    background: #f8f9fa;
    padding: 10px;
  }

  .tests::-webkit-scrollbar {
    width: 6px;
  }

  .tests::-webkit-scrollbar-thumb {
    background: #ddd;
    border-radius: 3px;
  }
  
  .test-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 12px 15px;
    font-size: 14px;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s;
    border: 1px solid transparent;
    margin-bottom: 8px;
    background: #fff;
    position: relative;
    overflow: hidden;
  }

  .test-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .test-item:hover::before {
    left: 100%;
  }

  .test-item:hover {
    background: #f0e6f5;
    color: #8e44ad;
    border-color: #8e44ad;
    transform: translateX(3px);
  }

  .test-item.active {
    background: #8e44ad;
    color: white;
    font-weight: bold;
    border-color: #6c3483;
    transform: translateX(5px);
    box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
  }
  
  .test-item img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #f0e6f5;
    border: 1px solid #ddd;
    transition: all 0.3s ease;
  }

  .test-item:hover img {
    transform: scale(1.1);
    border-color: #8e44ad;
  }
  
  .test-info {
    flex: 1;
  }
  
  .test-info h4 {
    font-size: 15px;
  }
  
  .test-info small {
    display: block;
    font-size: 12px;
    color: #666;
  }

  .test-item.active .test-info small {
    color: #f0e6f5;
  }

  /* Test creation section */
  .test-creation {
    flex: 1;
    background: #fff;
    border-radius: 12px;
    padding: 30px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
    overflow-y: auto;
  }

  .test-creation:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .test-header {
    margin-bottom: 30px;
    text-align: center;
  }

  .test-header h1 {
    font-size: 28px;
    color: #8e44ad;
    margin-bottom: 10px;
  }

  .test-input-group {
    margin-bottom: 25px;
  }

  .test-input-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #555;
  }

  .test-input-group input,
  .test-input-group textarea {
    width: 100%;
    padding: 15px;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 8px;
    transition: all 0.3s;
    background: #f8f9fa;
  }

  .test-input-group input:focus,
  .test-input-group textarea:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 8px rgba(142, 68, 173, 0.4);
    background: #fff;
  }

  .test-input-group input::placeholder,
  .test-input-group textarea::placeholder {
    color: #aaa;
  }

  .test-input-group textarea {
    min-height: 120px;
    resize: vertical;
  }

  .question-section {
    margin-top: 40px;
    border-top: 2px solid #eee;
    padding-top: 30px;
  }

  .question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .question-header h2 {
    font-size: 22px;
    color: #8e44ad;
  }

  .add-question-btn {
    background: #8e44ad;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .add-question-btn:hover {
    background: #6c3483;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(108, 52, 131, 0.3);
  }

  .question-item {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid #e9ecef;
    transition: all 0.3s ease;
  }

  .question-item:hover {
    background: #f0e6f5;
    border-color: #8e44ad;
    transform: translateX(3px);
  }

  .question-title {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
  }

  .question-title h3 {
    font-size: 18px;
    color: #555;
  }

  .question-content textarea {
    min-height: 100px;
    width: 100%;
    padding: 15px;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 8px;
    resize: vertical;
    transition: all 0.3s;
    background: #fff;
  }

  .question-content textarea:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 8px rgba(142, 68, 173, 0.4);
  }

  .button-group {
    display: flex;
    justify-content: flex-end;
    gap: 15px;
    margin-top: 30px;
  }

  .save-test-btn {
    padding: 12px 25px;
    background: #8e44ad;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .save-test-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .save-test-btn:hover::before {
    left: 100%;
  }

  .save-test-btn:hover {
    background: #6c3483;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(108, 52, 131, 0.3);
  }

  .ai-test-btn {
    padding: 12px 25px;
    background: #9b59b6;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    position: relative;
    overflow: hidden;
  }

  .ai-test-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .ai-test-btn:hover::before {
    left: 100%;
  }

  .ai-test-btn:hover {
    background: #8e44ad;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(142, 68, 173, 0.3);
  }

  /* AI Test Generation Modal */
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .modal-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .ai-test-modal {
    background: white;
    border-radius: 12px;
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
    transform: translateY(50px);
    transition: transform 0.4s ease;
  }

  .modal-overlay.active .ai-test-modal {
    transform: translateY(0);
  }

  .modal-header {
    background: #8e44ad;
    color: white;
    padding: 20px;
    border-radius: 12px 12px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .modal-header h2 {
    font-size: 24px;
    font-weight: 600;
  }

  .close-modal {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    transition: transform 0.3s ease;
  }

  .close-modal:hover {
    transform: rotate(90deg);
  }

  .modal-content {
    padding: 30px;
  }

  .test-config-section {
    margin-bottom: 30px;
  }

  .test-config-section h3 {
    font-size: 20px;
    color: #8e44ad;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #eee;
  }

  .config-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
  }

  .config-item {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 20px;
    border: 1px solid #e9ecef;
    transition: all 0.3s ease;
  }

  .config-item:hover {
    background: #f0e6f5;
    border-color: #8e44ad;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  }

  .config-item h4 {
    font-size: 16px;
    color: #555;
    margin-bottom: 15px;
  }

  .radio-group {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .radio-option {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .radio-option input[type="radio"] {
    width: 18px;
    height: 18px;
    accent-color: #8e44ad;
  }

  .radio-option label {
    font-size: 15px;
    color: #555;
    cursor: pointer;
  }

  .checkbox-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .checkbox-option {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .checkbox-option input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: #8e44ad;
  }

  .checkbox-option label {
    font-size: 15px;
    color: #555;
    cursor: pointer;
  }

  .generate-btn {
    display: block;
    width: 100%;
    padding: 15px;
    background: #8e44ad;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 20px;
    position: relative;
    overflow: hidden;
  }

  .generate-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .generate-btn:hover::before {
    left: 100%;
  }

  .generate-btn:hover {
    background: #6c3483;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(108, 52, 131, 0.3);
  }

  /* Students page layout */
  .students-layout {
    display: flex;
    gap: 20px;
    flex: 1;
  }

  /* Student list */
  .student-list-small {
    width: 250px;
    background: #fff;
    border-radius: 12px;
    padding: 15px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    gap: 10px;
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }

  .student-list-small:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .student-list-small input {
    width: 100%;
    padding: 10px;
    font-size: 13px;
    border: 1px solid #ddd;
    border-radius: 6px;
    transition: all 0.3s;
    background: #f8f9fa;
  }

  .student-list-small input:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 8px rgba(142, 68, 173, 0.4);
    background: #fff;
  }

  .students-small {
    flex: 1;
    margin-top: 10px;
    overflow-y: auto;
    max-height: 400px;
    padding: 5px;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 8px;
    background: #f8f9fa;
  }

  .student-item-small {
    padding: 8px 10px;
    font-size: 14px;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.3s;
    border: 1px solid transparent;
    background: #fff;
    margin-bottom: 5px;
    position: relative;
    overflow: hidden;
  }

  .student-item-small::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .student-item-small:hover::before {
    left: 100%;
  }

  .student-item-small:hover {
    background: #f0e6f5;
    color: #8e44ad;
    border-color: #8e44ad;
    transform: translateX(3px);
  }

  .student-item-small.active {
    background: #8e44ad;
    color: white;
    border-color: #6c3483;
    transform: translateX(5px);
    box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
  }

  /* Right panel */
  .student-details {
    flex: 1;
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }

  .student-details:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #e9ecef;
  }

  .tabs button {
    border: 1px solid #ddd;
    background: #f8f9fa;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .tabs button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(142, 68, 173, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .tabs button:hover::before {
    left: 100%;
  }

  .tabs button.active {
    background: #8e44ad;
    color: white;
    font-weight: bold;
    border-color: #6c3483;
    transform: translateY(-2px);
    box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
  }

  .tabs button:hover {
    background: #f0e6f5;
    color: #8e44ad;
    border-color: #8e44ad;
    transform: translateY(-2px);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid #e9ecef;
  }

  th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #e9ecef;
    font-size: 14px;
  }

  th {
    background: #8e44ad;
    color: white;
    font-weight: bold;
  }

  tr {
    transition: all 0.3s ease;
  }

  tr:hover {
    background: #f9f2fc;
    transform: translateX(3px);
  }

  /* Status badges */
  .status-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    transition: all 0.3s ease;
  }
  
  .status-badge:hover {
    transform: scale(1.1);
  }
  
  .status-completed {
    background-color: #e8f5e9;
    color: #2e7d32;
  }
  
  .status-pending {
    background-color: #ffecb3;
    color: #f57c00;
  }
  
  .status-missing {
    background-color: #ffcdd2;
    color: #c62828;
  }

  /* Grade tab layout */
  .grade-layout { 
    display: grid; 
    grid-template-columns: 1fr 1fr; 
    gap: 20px; 
  }
  
  .grade-card { 
    background: #fff; 
    border-radius: 12px; 
    padding: 15px; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.3s ease;
  }
  
  .grade-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }
  
  .grade-bottom { 
    grid-column: span 2; 
    display: flex; 
    justify-content: flex-start; 
    padding: 20px; 
  }
  
  .circular { 
    position: relative; 
    width: 160px; 
    height: 160px; 
    background: #f8f9fa;
    border-radius: 50%;
    border: 1px solid #e9ecef;
    transition: all 0.3s ease;
  }
  
  .circular:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }
  
  .circular canvas { 
    position: absolute; 
    top: 0; 
    left: 0; 
  }
  
  .circular span { 
    position: absolute; 
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%); 
    font-size: 28px; 
    font-weight: bold; 
    transition: all 0.3s ease;
  }
  
  .circular:hover span {
    color: #8e44ad;
  }

  /* Upload page layout */
  .upload-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    flex: 1;
    margin-top: 20px;
    height: calc(100vh - 180px);
  }

  /* Upload section */
  .upload-section {
    background: #fff;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
  }

  .upload-section:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  .section-header {
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #eee;
  }

  .section-header h2 {
    font-size: 22px;
    color: #8e44ad;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .section-header h2 i {
    color: #8e44ad;
  }

  /* Upload box */
  .upload-box {
    border: 2px dashed #8e44ad;
    border-radius: 12px;
    padding: 40px 20px;
    text-align: center;
    background: #f8f9fa;
    margin-bottom: 20px;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .upload-box:hover {
    background: #f0e6f5;
    transform: translateY(-3px);
  }

  .upload-box i {
    font-size: 48px;
    color: #8e44ad;
    margin-bottom: 15px;
  }

  .upload-box h3 {
    font-size: 18px;
    color: #555;
    margin-bottom: 10px;
  }

  .upload-box p {
    color: #777;
    font-size: 14px;
  }

  .upload-btn {
    padding: 12px 25px;
    background: #8e44ad;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    position: relative;
    overflow: hidden;
  }

  .upload-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .upload-btn:hover::before {
    left: 100%;
  }

  .upload-btn:hover {
    background: #6c3483;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(108, 52, 131, 0.3);
  }

  /* File list */
  .file-list {
    margin-top: 20px;
    flex: 1;
    overflow-y: auto;
  }

  .file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    margin-bottom: 10px;
    border: 1px solid #e9ecef;
    transition: all 0.3s ease;
  }

  .file-item:hover {
    background: #f0e6f5;
    border-color: #8e44ad;
    transform: translateX(3px);
  }

  .file-info {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .file-icon {
    width: 40px;
    height: 40px;
    background: #8e44ad;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 18px;
  }

  .file-details h4 {
    font-size: 15px;
    color: #333;
    margin-bottom: 4px;
  }

  .file-details span {
    font-size: 13px;
    color: #777;
  }

  .file-actions {
    display: flex;
    gap: 10px;
  }

  .file-action-btn {
    background: none;
    border: none;
    color: #8e44ad;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s ease;
  }

  .file-action-btn:hover {
    color: #6c3483;
    transform: scale(1.2);
  }

  /* Reference materials section */
  .reference-section {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid #eee;
  }

  .reference-section h3 {
    font-size: 18px;
    color: #8e44ad;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .reference-section h3 i {
    color: #8e44ad;
  }

  /* Popup styles */
  .popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.2);
    z-index: 1000;
    width: 400px;
    max-width: 90%;
    border: 1px solid rgba(0,0,0,0.08);
    animation: popIn 0.3s ease;
  }

  @keyframes popIn {
    from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
    to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  }

  .popup h3 {
    margin-bottom: 15px;
    color: #8e44ad;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .popup-content {
    max-height: 300px;
    overflow-y: auto;
    padding: 10px 0;
    color: #333;
  }

  .form-group {
    margin-bottom: 15px;
  }

  .form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
  }

  .form-group input, .form-group select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .form-group input:focus, .form-group select:focus {
    outline: none;
    border-color: #8e44ad;
    box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.2);
  }

  .form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
  }

  .form-actions button {
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .btn-primary {
    background: #8e44ad;
    color: white;
    border: none;
  }

  .btn-primary:hover {
    background: #793a9c;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .btn-secondary {
    background: #6c757d;
    color: white;
    border: none;
  }

  .btn-secondary:hover {
    background: #5a6268;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .popup-close {
    position: absolute;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: #999;
    transition: all 0.3s ease;
  }

  .popup-close:hover {
    color: #ff6b6b;
    transform: rotate(90deg);
  }

  .overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 999;
    animation: fadeIn 0.3s ease;
  }

  /* Purple refresh button */
  .refresh-btn {
    background: #8e44ad;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    margin-top: 15px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 500;
    box-shadow: 0 2px 6px rgba(142, 68, 173, 0.3);
  }

  .refresh-btn:hover {
    background: #793a9c;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(142, 68, 173, 0.4);
  }

  .refresh-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 4px rgba(142, 68, 173, 0.3);
  }

  .refresh-btn:disabled {
    background: #b39ddb;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .empty-state {
    text-align: center;
    padding: 30px 0;
    color: #888;
    animation: fadeIn 0.5s ease;
  }

  .empty-state i {
    font-size: 40px;
    margin-bottom: 10px;
    color: #ddd;
  }

  .loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255,255,255,.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Loading indicator */
  .loading-full {
    text-align: center;
    padding: 20px;
    color: #8e44ad;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
  }

  .loading-full i {
    font-size: 24px;
    margin-bottom: 10px;
    animation: spin 1s linear infinite;
  }

  /* Menu toggle for mobile (hidden by default) */
  .menu-toggle {
    display: none;
    position: fixed;
    top: 20px;
    right: 20px;
    background: #8e44ad;
    color: white;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 24px;
    cursor: pointer;
    z-index: 1001;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
  }

  .menu-toggle:hover {
    background: #793a9c;
    transform: rotate(90deg);
  }

  /* Responsive design */
  @media (max-width: 1200px) {
    .feedback-panel {
      grid-template-columns: 1fr 1fr;
    }
    
    .panel-card:last-child {
      grid-column: span 2;
    }
  }

  @media (max-width: 992px) {
    .sidebar {
      position: fixed;
      left: -250px;
      height: 100%;
      z-index: 1000;
      margin-top: 0;
      border-radius: 0;
      transition: left 0.3s ease;
    }
    
    .sidebar.active {
      left: 0;
    }
    
    .main {
      margin-left: 0;
      margin-top: 20px;
    }
    
    .menu-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .dashboard {
      flex-direction: column;
    }
    
    .top-left-logo {
      top: 10px;
      left: 10px;
      height: 120px;
    }
    
    .feedback-layout {
      flex-direction: column;
    }
    
    .student-list {
      width: 100%;
    }
    
    .feedback-panel {
      grid-template-columns: 1fr;
    }
    
    .panel-card:last-child {
      grid-column: span 1;
    }
    
    .practice-layout {
      flex-direction: column;
    }
    
    .test-list {
      width: 100%;
    }
    
    .students-layout {
      flex-direction: column;
    }
    
    .student-list-small {
      width: 100%;
    }
    
    .upload-layout {
      grid-template-columns: 1fr;
    }

    .config-grid {
      grid-template-columns: 1fr;
    }

    .checkbox-group {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 576px) {
    .top-bar {
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .top-user {
      order: -1;
      width: 100%;
      justify-content: center;
      margin-bottom: 10px;
    }
    
    .welcome-box h1 {
      font-size: 20px;
    }
    
    .popup {
      width: 95%;
      padding: 15px;
    }
    
    .student-profile-section {
      flex-direction: column;
      text-align: center;
    }
    
    .question-header {
      flex-direction: column;
      gap: 15px;
      align-items: flex-start;
    }
    
    .button-group {
      flex-direction: column;
    }

    .ai-test-modal {
      width: 95%;
      margin: 10px;
    }

    .modal-content {
      padding: 20px;
    }
    
    .grade-layout {
      grid-template-columns: 1fr;
    }
    
    .grade-bottom {
      grid-column: span 1;
    }
    
    .file-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 15px;
    }
    
    .file-actions {
      align-self: flex-end;
    }
  }
</style>
</head>
<body>
  <!-- Top left logo -->
  <img src="neuro grade logo.jpg" alt="NeuroGrade Logo" class="top-left-logo">

  <!-- Mobile menu toggle -->
  <button class="menu-toggle" id="menu-toggle">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="nav">
      <a href="#"><button class="active" data-page="home"><i class="fas fa-home"></i> Home</button></a>
      <a href="#"><button data-page="task"><i class="fas fa-tasks"></i> Task</button></a>
      <a href="#"><button data-page="students"><i class="fas fa-users"></i> Students</button></a>
      <a href="#"><button data-page="practice"><i class="fas fa-graduation-cap"></i> Practice</button></a>
      <a href="#"><button data-page="feedback"><i class="fas fa-comment-dots"></i> Feedback</button></a>
    </div>
  </div>

  <!-- Main -->
  <div class="main">
    <!-- Top bar -->
    <div class="top-bar">
      <a href="#" class="icon-link" id="mail-icon">
        <i class="fas fa-envelope"></i>
        <span class="icon-badge">0</span>
      </a>
      <a href="#" class="icon-link" id="notification-icon">
        <i class="fas fa-bell"></i>
        <span class="icon-badge">0</span>
      </a>
      <div class="top-user">
        <span><b>CAT-WOMAN</b><br><small>CATBAT12@gmail.com</small></span>
        <img src="https://placehold.co/35x35/8e44ad/FFFFFF?text=C" alt="User">
      </div>
    </div>

    <!-- Home Page -->
    <div class="page-content active" id="home-page">
      <!-- Welcome -->
      <div class="welcome-box">
        <h1>WELCOME BACK, CAT-WOMAN!</h1>
        <p>Here is a quick overview of your class and students progress</p>
      </div>

      <!-- Dashboard content -->
      <div class="dashboard">
        <!-- Left column -->
        <div class="left-col">
          <div class="average-card">
            <h2>Class Average Score</h2>
            <p class="average" id="class-average">--.--%</p>
            <p class="change"><i class="fas fa-arrow-up"></i> <span id="average-change">Calculating...</span></p>
            <p class="students-count" id="students-count">Loading data from database...</p>
            <button class="refresh-btn" id="refresh-btn">
              <i class="fas fa-sync-alt"></i> Refresh Data
            </button>
          </div>

          <div class="subjects-card">
            <div class="subjects-header">
              <h2>Your Subjects</h2>
              <button class="add-subject-btn" id="add-subject-btn">
                <i class="fas fa-plus"></i> Add Subject
              </button>
            </div>
            
            <div id="subjects-container">
              <div class="empty-state">
                <i class="fas fa-book-open"></i>
                <p>No subjects yet</p>
                <p>Subjects will be loaded from your database</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Right column -->
        <div class="right-col">
          <h2>Academic Overview</h2>
          <p>Your classes academic performance over time.</p>
          <div class="graph-container">
            <div>
              <i class="fas fa-chart-line" style="font-size: 40px; margin-bottom: 10px;"></i>
              <p>Graph data will be loaded from database</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Task Page -->
    <div class="page-content" id="task-page">
      <div class="upload-layout">
        <!-- Uploaded Tests Section -->
        <div class="upload-section">
          <div class="section-header">
            <h2><i class="fas fa-file-alt"></i> Uploaded Tests</h2>
          </div>
          <div class="file-list">
            <div class="file-item">
              <div class="file-info">
                <div class="file-icon">
                  <i class="fas fa-file-pdf"></i>
                </div>
                <div class="file-details">
                  <h4>MATH511 Midterm Exam</h4>
                  <span>12/04/2024</span>
                </div>
              </div>
              <div class="file-actions">
                <button class="file-action-btn"><i class="fas fa-download"></i></button>
                <button class="file-action-btn"><i class="fas fa-trash"></i></button>
              </div>
            </div>
            
            <div class="file-item">
              <div class="file-info">
                <div class="file-icon">
                  <i class="fas fa-file-word"></i>
                </div>
                <div class="file-details">
                  <h4>MATH511 Final Task</h4>
                  <span>11/10/2024</span>
                </div>
              </div>
              <div class="file-actions">
                <button class="file-action-btn"><i class="fas fa-download"></i></button>
                <button class="file-action-btn"><i class="fas fa-trash"></i></button>
              </div>
            </div>
            
            <div class="file-item">
              <div class="file-info">
                <div class="file-icon">
                  <i class="fas fa-file-excel"></i>
                </div>
                <div class="file-details">
                  <h4>MATH511 Student List</h4>
                  <span>22/04/2025</span>
                </div>
              </div>
              <div class="file-actions">
                <button class="file-action-btn"><i class="fas fa-download"></i></button>
                <button class="file-action-btn"><i class="fas fa-trash"></i></button>
              </div>
            </div>
          </div>
        </div>

        <!-- Upload Tests Section -->
        <div class="upload-section">
          <div class="section-header">
            <h2><i class="fas fa-tasks"></i> Upload Tests</h2>
          </div>
          <div class="upload-box" id="test-drop-zone">
            <i class="fas fa-cloud-upload-alt"></i>
            <h3>Drag and drop your test here</h3>
            <p>or click to browse files</p>
            <input type="file" id="test-file-input" style="display: none;">
          </div>
          <button class="upload-btn" id="test-upload-button">UPLOAD TEST</button>
          
          <!-- Reference materials for tests -->
          <div class="reference-section">
            <h3><i class="fas fa-book"></i> Reference Materials for AI Marking</h3>
            <div class="upload-box" id="test-reference-drop-zone">
              <i class="fas fa-file-upload"></i>
              <h3>Upload rubric, study guide, or reference material</h3>
              <p>AI will use this as reference when marking tests</p>
              <input type="file" id="test-reference-file-input" style="display: none;">
            </div>
            <button class="upload-btn" id="test-reference-upload-button">UPLOAD REFERENCE</button>
          </div>
        </div>

        <!-- Uploaded Assignments Section -->
        <div class="upload-section">
          <div class="section-header">
            <h2><i class="fas fa-clipboard-list"></i> Uploaded Assignments</h2>
          </div>
          <div class="file-list">
            <div class="file-item">
              <div class="file-info">
                <div class="file-icon">
                  <i class="fas fa-file-pdf"></i>
                </div>
                <div class="file-details">
                  <h4>MATH511 Assignment 1</h4>
                  <span>12/04/2024</span>
                </div>
              </div>
              <div class="file-actions">
                <button class="file-action-btn"><i class="fas fa-download"></i></button>
                <button class="file-action-btn"><i class="fas fa-trash"></i></button>
              </div>
            </div>
            
            <div class="file-item">
              <div class="file-info">
                <div class="file-icon">
                  <i class="fas fa-file-word"></i>
                </div>
                <div class="file-details">
                  <h4>MATH511 Research Paper</h4>
                  <span>12/04/2024</span>
                </div>
              </div>
              <div class="file-actions">
                <button class="file-action-btn"><i class="fas fa-download"></i></button>
                <button class="file-action-btn"><i class="fas fa-trash"></i></button>
              </div>
            </div>
            
            <div class="file-item">
              <div class="file-info">
                <div class="file-icon">
                  <i class="fas fa-file-excel"></i>
                </div>
                <div class="file-details">
                  <h4>MATH511 Grade Sheet</h4>
                  <span>12/04/2024</span>
                </div>
              </div>
              <div class="file-actions">
                <button class="file-action-btn"><i class="fas fa-download"></i></button>
                <button class="file-action-btn"><i class="fas fa-trash"></i></button>
              </div>
            </div>
          </div>
        </div>

        <!-- Upload Assignments Section -->
        <div class="upload-section">
          <div class="section-header">
            <h2><i class="fas fa-tasks"></i> Upload Assignments</h2>
          </div>
          <div class="upload-box" id="assignment-drop-zone">
            <i class="fas fa-cloud-upload-alt"></i>
            <h3>Drag and drop your assignment here</h3>
            <p>or click to browse files</p>
            <input type="file" id="assignment-file-input" style="display: none;">
          </div>
          <button class="upload-btn" id="assignment-upload-button">UPLOAD ASSIGNMENT</button>
          
          <!-- Reference materials for assignments -->
          <div class="reference-section">
            <h3><i class="fas fa-book"></i> Reference Materials for AI Marking</h3>
            <div class="upload-box" id="assignment-reference-drop-zone">
              <i class="fas fa-file-upload"></i>
              <h3>Upload rubric, study guide, or reference material</h3>
              <p>AI will use this as reference when marking assignments</p>
              <input type="file" id="assignment-reference-file-input" style="display: none;">
            </div>
            <button class="upload-btn" id="assignment-reference-upload-button">UPLOAD REFERENCE</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Students Page -->
    <div class="page-content" id="students-page">
      <div class="students-layout">
        <!-- Left: Student list -->
        <div class="student-list-small">
          <input type="text" placeholder="Student number" id="studentNumberSearch">
          <input type="text" placeholder="Name" id="studentNameSearch">

          <div class="students-small" id="studentList">
            <!-- Student list will be populated from database -->
            <div class="loading">
              <i class="fas fa-spinner"></i>
              <p>Loading students from database...</p>
            </div>
          </div>
        </div>

        <!-- Right: Assignments/Tests/Grades -->
        <div class="student-details">
          <div class="tabs">
            <button class="tab-btn" data-tab="assignments">Assignments</button>
            <button class="tab-btn" data-tab="tests">Tests</button>
            <button class="tab-btn active" data-tab="grades">Grades</button>
          </div>

          <!-- Tab content -->
          <div id="assignments" class="tab-content" style="display:none;">
            <div class="loading">
              <i class="fas fa-spinner"></i>
              <p>Select a student to view assignments</p>
            </div>
          </div>

          <div id="tests" class="tab-content" style="display:none;">
            <div class="loading">
              <i class="fas fa-spinner"></i>
              <p>Select a student to view tests</p>
            </div>
          </div>

          <div id="grades" class="tab-content">
            <!-- Grades Tab Content -->
            <div class="grade-layout">
              <div class="grade-card">
                <h4>Assignments</h4>
                <canvas id="assignmentsChart"></canvas>
              </div>
              <div class="grade-card">
                <h4>Tests</h4>
                <canvas id="testsChart"></canvas>
              </div>
              <div class="grade-bottom">
                <div class="grade-card">
                  <h4>Overall Grade</h4>
                  <div class="circular">
                    <canvas id="overallGradeChart" width="160" height="160"></canvas>
                    <span id="gradeText">0%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Practice Page -->
    <div class="page-content" id="practice-page">
      <div class="practice-layout">
        <div class="test-list">
          <div class="test-search">
            <input type="text" placeholder="Search tests..." id="testSearch">
          </div>
          <div class="tests">
            <div class="test-item active">
              <div class="test-info">
                <h4>New Test</h4>
                <small>Currently editing</small>
              </div>
            </div>
            <div class="test-item">
              <div class="test-info">
                <h4>Midterm Exam</h4>
                <small>Created: Oct 15, 2023</small>
              </div>
            </div>
            <div class="test-item">
              <div class="test-info">
                <h4>Quiz 1</h4>
                <small>Created: Sep 28, 2023</small>
              </div>
            </div>
            <div class="test-item">
              <div class="test-info">
                <h4>Final Exam</h4>
                <small>Created: Nov 5, 2023</small>
              </div>
            </div>
          </div>
        </div>

        <div class="test-creation">
          <div class="test-header">
            <h1>TEST CREATION</h1>
          </div>

          <div class="test-input-group">
            <label for="test-name">Name</label>
            <input type="text" id="test-name" placeholder="Enter test name">
          </div>

          <div class="test-input-group">
            <label for="test-description">Test Description</label>
            <textarea id="test-description" placeholder="Enter test description"></textarea>
          </div>

          <div class="question-section">
            <div class="question-header">
              <h2>Questions</h2>
              <button class="add-question-btn" id="add-question-btn">
                <i class="fas fa-plus"></i> Add Question
              </button>
            </div>

            <div class="questions-list">
              <div class="question-item">
                <div class="question-title">
                  <h3>QUESTION 1</h3>
                </div>
                <div class="question-content">
                  <textarea placeholder="Enter question content"></textarea>
                </div>
              </div>

              <div class="question-item">
                <div class="question-title">
                  <h3>QUESTION 2</h3>
                </div>
                <div class="question-content">
                  <textarea placeholder="Enter question content"></textarea>
                </div>
              </div>
            </div>
          </div>

          <div class="button-group">
            <button class="ai-test-btn" id="ai-test-btn">
              <i class="fas fa-robot"></i> AI GENERATE TEST
            </button>
            <button class="save-test-btn" id="save-test-btn">
              SAVE TEST
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Feedback Page -->
    <div class="page-content" id="feedback-page">
      <div class="feedback-layout">
        <div class="student-list">
          <div class="student-search">
            <input type="text" placeholder="Student number" id="studentNumberSearchFeedback">
            <input type="text" placeholder="Name" id="studentNameSearchFeedback">
          </div>
          <div class="students">
            <!-- Student list will be populated from database -->
            <div class="loading">
              <i class="fas fa-spinner"></i>
              <p>Loading students from database...</p>
            </div>
          </div>
        </div>

        <div class="right-panel-container">
          <!-- Student profile section - outside of the task panel -->
          <div class="student-profile-section">
            <img src="https://placehold.co/80x80/9b59b6/FFFFFF?text=?" alt="Student" id="student-profile-img">
            <div class="student-profile-info">
              <h2 id="student-name">Select a student</h2>
              <div class="student-number" id="student-number">Student Number: </div>
            </div>
          </div>

          <div class="feedback-panel">
            <div class="panel-card">
              <h3><i class="fas fa-list-ul"></i> TASK</h3>
              <div class="task-list">
                <!-- Task list will be populated from database -->
                <div class="loading">
                  <i class="fas fa-spinner"></i>
                  <p>Select a student to view tasks</p>
                </div>
              </div>
            </div>
            
            <div class="panel-card">
              <h3><i class="fas fa-robot"></i> AUTOGRADER RESULTS</h3>
              <div class="autograder-results">
                <!-- Autograder results will be populated from database -->
                <div class="loading">
                  <i class="fas fa-spinner"></i>
                  <p>Select a task to view results</p>
                </div>
              </div>
            </div>
            
            <div class="panel-card">
              <h3><i class="fas fa-pen-to-square"></i> MANUAL FEEDBACK</h3>
              <div class="manual-feedback">
                <div>
                  <div class="feedback-header">
                    <b>PRIVATE FEEDBACK FOR STUDENT</b>
                  </div>
                  <textarea class="feedback-textarea" id="private-feedback-input" placeholder="Enter private feedback for this student..."></textarea>
                </div>
                <div>
                  <div class="feedback-header">
                    <b>FEEDBACK FOR CLASS</b>
                  </div>
                  <textarea class="feedback-textarea" id="class-feedback-input" placeholder="Enter general feedback for the class..."></textarea>
                </div>
                <div class="flex-spacer"></div>
                <div class="grade-input-container">
                  <h4>ADJUSTED GRADE</h4>
                  <div class="grade-input-wrapper">
                    <input type="number" class="grade-input" id="adjusted-grade" min="0" max="100" value="">
                    <span class="grade-slash">/</span>
                    <span class="grade-total">100</span>
                  </div>
                </div>
                <button class="save-button" id="save-feedback-btn" onclick="saveFeedback()">SAVE FEEDBACK</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- AI Test Generation Modal -->
  <div class="modal-overlay" id="ai-test-modal">
    <div class="ai-test-modal">
      <div class="modal-header">
        <h2>AI Test Generation</h2>
        <button class="close-modal" id="close-modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-content">
        <div class="test-config-section">
          <h3>Test Configuration</h3>
          <div class="config-grid">
            <div class="config-item">
              <h4>DIFFICULTY</h4>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" id="difficulty-easy" name="difficulty" value="easy" checked>
                  <label for="difficulty-easy">Easy</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="difficulty-medium" name="difficulty" value="medium">
                  <label for="difficulty-medium">Medium</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="difficulty-hard" name="difficulty" value="hard">
                  <label for="difficulty-hard">Hard</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="difficulty-very-hard" name="difficulty" value="very-hard">
                  <label for="difficulty-very-hard">Very Hard</label>
                </div>
              </div>
            </div>
            
            <div class="config-item">
              <h4>QUESTION TYPES</h4>
              <div class="checkbox-group">
                <div class="checkbox-option">
                  <input type="checkbox" id="type-mcq" name="question-types" value="mcq" checked>
                  <label for="type-mcq">Multiple Choice (MCQ)</label>
                </div>
                <div class="checkbox-option">
                  <input type="checkbox" id="type-short" name="question-types" value="short" checked>
                  <label for="type-short">Short Answer</label>
                </div>
                <div class="checkbox-option">
                  <input type="checkbox" id="type-long" name="question-types" value="long">
                  <label for="type-long">Long Answer</label>
                </div>
                <div class="checkbox-option">
                  <input type="checkbox" id="type-essay" name="question-types" value="essay">
                  <label for="type-essay">Essay</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="test-config-section">
          <h3>Test Content</h3>
          <div class="config-grid">
            <div class="config-item">
              <h4>NUMBER OF QUESTIONS</h4>
              <input type="number" id="question-count" min="1" max="50" value="10" style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #ddd;">
            </div>
            
            <div class="config-item">
              <h4>TOPICS TO INCLUDE</h4>
              <textarea placeholder="Enter topics (separated by commas)" style="width: 100%; min-height: 100px; padding: 10px; border-radius: 6px; border: 1px solid #ddd; resize: vertical;"></textarea>
            </div>
          </div>
        </div>
        
        <button class="generate-btn" id="generate-test-btn">
          GENERATE TEST
        </button>
      </div>
    </div>
  </div>

  <!-- Mail Popup -->
  <div class="popup" id="mail-popup">
    <button class="popup-close">&times;</button>
    <h3><i class="fas fa-envelope"></i> Messages</h3>
    <div class="popup-content">
      <div class="empty-state">
        <i class="fas fa-inbox" style="font-size: 50px; margin-bottom: 15px;"></i>
        <p>No messages yet</p>
        <p>Messages will be loaded from database</p>
      </div>
    </div>
  </div>

  <!-- Notification Popup -->
  <div class="popup" id="notification-popup">
    <button class="popup-close">&times;</button>
    <h3><i class="fas fa-bell"></i> Notifications</h3>
    <div class="popup-content">
      <div class="empty-state">
        <i class="far fa-bell-slash" style="font-size: 50px; margin-bottom: 15px;"></i>
        <p>No notifications yet</p>
        <p>Notifications will be loaded from database</p>
      </div>
    </div>
  </div>

  <!-- Add/Edit Subject Popup -->
  <div class="popup" id="subject-popup">
    <button class="popup-close">&times;</button>
    <h3><i class="fas fa-book"></i> <span id="subject-popup-title">Add Subject</span></h3>
    <div class="popup-content">
      <div class="form-group">
        <label for="subject-name">Subject Name</label>
        <input type="text" id="subject-name" placeholder="Enter subject name">
      </div>
      <div class="form-group">
        <label for="subject-year">Year</label>
        <select id="subject-year">
          <option value="">Select year</option>
          <option value="1st year">1st Year</option>
          <option value="2nd year">2nd Year</option>
          <option value="3rd year">3rd Year</option>
          <option value="4th year">4th Year</option>
          <option value="5th year">5th Year</option>
        </select>
      </div>
      <div class="form-actions">
        <button class="btn-secondary" id="cancel-subject">Cancel</button>
        <button class="btn-primary" id="save-subject">Save</button>
      </div>
    </div>
  </div>

  <!-- Overlay -->
  <div class="overlay" id="overlay"></div>

<script>
  // Navigation functionality
  const navButtons = document.querySelectorAll(".nav button");
  const pageContents = document.querySelectorAll(".page-content");
  
  navButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      
      // Remove active class from all buttons
      navButtons.forEach(b => b.classList.remove('active'));
      
      // Add active class to clicked button
      btn.classList.add('active');
      
      // Get the page name from data attribute
      const page = btn.getAttribute('data-page');
      
      // Hide all page contents
      pageContents.forEach(content => {
        content.classList.remove('active');
      });
      
      // Show the selected page content
      document.getElementById(`${page}-page`).classList.add('active');
      
      // Load data for the selected page
      if (page === 'students') {
        loadStudentsFromDatabase();
      } else if (page === 'feedback') {
        loadFeedbackStudents();
      }
      
      // Close sidebar on mobile after selection
      if (window.innerWidth <= 992) {
        sidebar.classList.remove('active');
        overlay.style.display = 'none';
      }
    });
  });

  // Function to calculate class average from student marks
  function calculateClassAverage(students) {
    if (!students || students.length === 0) return 0;
    
    const totalMarks = students.reduce((sum, student) => sum + student.marks, 0);
    return (totalMarks / students.length).toFixed(1);
  }

  // Function to calculate average change compared to previous data
  function calculateAverageChange(currentAvg, previousAvg) {
    if (!previousAvg) return { change: 0, direction: 'stable' };
    
    const change = ((currentAvg - previousAvg) / previousAvg * 100).toFixed(1);
    return {
      change: Math.abs(change),
      direction: change >= 0 ? 'increased' : 'decreased'
    };
  }

  // Function to update the class average display
  function updateClassAverage(students, previousAverage) {
    const average = calculateClassAverage(students);
    const averageElement = document.getElementById('class-average');
    const studentsCountElement = document.getElementById('students-count');
    const averageChangeElement = document.getElementById('average-change');
    
    averageElement.textContent = `${average}%`;
    studentsCountElement.textContent = `Calculated from ${students.length} students`;
    
    // Calculate and display change
    const changeData = calculateAverageChange(parseFloat(average), previousAverage);
    if (changeData.direction === 'increased') {
      averageChangeElement.innerHTML = `<i class="fas fa-arrow-up"></i> increased by ${changeData.change}% from last week`;
      averageChangeElement.style.color = '#28a745';
    } else if (changeData.direction === 'decreased') {
      averageChangeElement.innerHTML = `<i class="fas fa-arrow-down"></i> decreased by ${changeData.change}% from last week`;
      averageChangeElement.style.color = '#dc3545';
    } else {
      averageChangeElement.innerHTML = `No change from last week`;
      averageChangeElement.style.color = '#6c757d';
    }
    
    // Add animation effect
    averageElement.style.transition = 'all 0.5s ease';
    averageElement.style.transform = 'scale(1.1)';
    
    setTimeout(() => {
      averageElement.style.transform = 'scale(1)';
    }, 500);
    
    return parseFloat(average);
  }

  // Function to fetch student data from your database
  async function fetchStudentData() {
    try {
      // REPLACE THIS WITH YOUR DATABASE CONNECTION CODE
      // Example using fetch API:
      /*
      const response = await fetch('/api/students');
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      const students = await response.json();
      return students;
      */
      
      // For now, return empty array - you will connect this to your actual database
      return [];
      
    } catch (error) {
      console.error('Error fetching student data:', error);
      return [];
    }
  }

  // Function to fetch subjects from your database
  async function fetchSubjects() {
    try {
      // REPLACE THIS WITH YOUR DATABASE CONNECTION CODE
      // Example using fetch API:
      /*
      const response = await fetch('/api/subjects');
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      const subjects = await response.json();
      return subjects;
      */
      
      // For demonstration, return sample data
      return [
        { id: 1, name: "Math 511", year: "1st year" },
        { id: 2, name: "Pro 741", year: "2nd year" },
        { id: 3, name: "AI 700", year: "3rd year" }
      ];
      
    } catch (error) {
      console.error('Error fetching subjects:', error);
      return [];
    }
  }

  // Function to render subjects in the UI
  function renderSubjects(subjects) {
    const container = document.getElementById('subjects-container');
    
    if (subjects.length === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-book-open"></i>
          <p>No subjects yet</p>
          <p>Click "Add Subject" to create your first subject</p>
        </div>
      `;
      return;
    }
    
    container.innerHTML = subjects.map(subject => `
      <div class="subject-item" data-id="${subject.id}">
        <div class="subject-info">
          <h3>${subject.name}</h3>
          <p>${subject.year}</p>
        </div>
        <div class="subject-actions">
          <button class="edit-btn" data-id="${subject.id}">
            <i class="fas fa-edit"></i> Edit
          </button>
          <button data-id="${subject.id}">
            <i class="fas fa-eye"></i> View
          </button>
        </div>
      </div>
    `).join('');
    
    // Add event listeners to edit buttons
    document.querySelectorAll('.edit-btn').forEach(button => {
      button.addEventListener('click', (e) => {
        const subjectId = e.currentTarget.getAttribute('data-id');
        const subject = subjects.find(s => s.id == subjectId);
        openSubjectPopup(subject);
      });
    });
  }

  // Function to open subject popup for adding/editing
  function openSubjectPopup(subject = null) {
    const popup = document.getElementById('subject-popup');
    const title = document.getElementById('subject-popup-title');
    const nameInput = document.getElementById('subject-name');
    const yearSelect = document.getElementById('subject-year');
    
    if (subject) {
      // Editing existing subject
      title.textContent = 'Edit Subject';
      nameInput.value = subject.name;
      yearSelect.value = subject.year;
      popup.setAttribute('data-edit-id', subject.id);
    } else {
      // Adding new subject
      title.textContent = 'Add Subject';
      nameInput.value = '';
      yearSelect.value = '';
      popup.removeAttribute('data-edit-id');
    }
    
    showPopup(popup);
  }

  // Function to save subject (add or update)
  async function saveSubject(subjectData) {
    try {
      // REPLACE THIS WITH YOUR DATABASE CONNECTION CODE
      // Example using fetch API:
      /*
      const url = subjectData.id ? `/api/subjects/${subjectData.id}` : '/api/subjects';
      const method = subjectData.id ? 'PUT' : 'POST';
      
      const response = await fetch(url, {
        method: method,
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(subjectData),
      });
      
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      
      return await response.json();
      */
      
      // For demonstration, simulate a successful save
      console.log('Subject saved:', subjectData);
      return { success: true, message: 'Subject saved successfully' };
      
    } catch (error) {
      console.error('Error saving subject:', error);
      return { success: false, message: 'Error saving subject' };
    }
  }

  // Function to refresh data from the database
  async function refreshData() {
    const refreshBtn = document.getElementById('refresh-btn');
    const originalText = refreshBtn.innerHTML;
    
    // Show loading state
    refreshBtn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Loading...';
    refreshBtn.disabled = true;
    
    try {
      // Get the current average before updating
      const currentAverage = parseFloat(document.getElementById('class-average').textContent);
      
      // Fetch new data from database
      const students = await fetchStudentData();
      const subjects = await fetchSubjects();
      
      // Update the display with new data
      const newAverage = updateClassAverage(students, isNaN(currentAverage) ? null : currentAverage);
      renderSubjects(subjects);
      
      // Show success message
      alert(`Data refreshed successfully! Loaded ${students.length} student records and ${subjects.length} subjects from the database.`);
      
      return newAverage;
    } catch (error) {
      alert('Error refreshing data. Please try again.');
      console.error('Refresh error:', error);
      return null;
    } finally {
      // Restore button state
      refreshBtn.innerHTML = originalText;
      refreshBtn.disabled = false;
    }
  }

  // Menu interactivity
  const menuToggle = document.getElementById('menu-toggle');
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('overlay');

  // Toggle sidebar on mobile
  menuToggle.addEventListener('click', () => {
    sidebar.classList.toggle('active');
    overlay.style.display = sidebar.classList.contains('active') ? 'block' : 'none';
  });

  // Close sidebar when clicking on overlay
  overlay.addEventListener('click', () => {
    sidebar.classList.remove('active');
    overlay.style.display = 'none';
  });

  // Popup functionality
  const mailIcon = document.getElementById('mail-icon');
  const notificationIcon = document.getElementById('notification-icon');
  const mailPopup = document.getElementById('mail-popup');
  const notificationPopup = document.getElementById('notification-popup');
  const subjectPopup = document.getElementById('subject-popup');
  const closeButtons = document.querySelectorAll('.popup-close');
  const refreshBtn = document.getElementById('refresh-btn');
  const addSubjectBtn = document.getElementById('add-subject-btn');
  const cancelSubjectBtn = document.getElementById('cancel-subject');
  const saveSubjectBtn = document.getElementById('save-subject');

  function showPopup(popup) {
    popup.style.display = 'block';
    overlay.style.display = 'block';
    document.body.style.overflow = 'hidden';
  }

  function hidePopups() {
    document.querySelectorAll('.popup').forEach(popup => {
      popup.style.display = 'none';
    });
    overlay.style.display = 'none';
    document.body.style.overflow = 'auto';
  }

  mailIcon.addEventListener('click', (e) => {
    e.preventDefault();
    showPopup(mailPopup);
  });

  notificationIcon.addEventListener('click', (e) => {
    e.preventDefault();
    showPopup(notificationPopup);
  });

  addSubjectBtn.addEventListener('click', () => {
    openSubjectPopup();
  });

  cancelSubjectBtn.addEventListener('click', hidePopups);

  saveSubjectBtn.addEventListener('click', async () => {
    const name = document.getElementById('subject-name').value;
    const year = document.getElementById('subject-year').value;
    const editId = subjectPopup.getAttribute('data-edit-id');
    
    if (!name || !year) {
      alert('Please fill in all fields');
      return;
    }
    
    const subjectData = { name, year };
    if (editId) {
      subjectData.id = editId;
    }
    
    const result = await saveSubject(subjectData);
    
    if (result.success) {
      alert(result.message);
      hidePopups();
      // Refresh the subjects list
      const subjects = await fetchSubjects();
      renderSubjects(subjects);
    } else {
      alert(result.message);
    }
  });

  closeButtons.forEach(button => {
    button.addEventListener('click', hidePopups);
  });

  // Refresh button event
  refreshBtn.addEventListener('click', refreshData);

  // Close popup when pressing Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      hidePopups();
      sidebar.classList.remove('active');
    }
  });

  // Chart instances
  let assignmentsChart, testsChart, overallGradeChart;

  // Initialize charts with zero data
  function initCharts() {
    // Updated labels to include months up to November
    const monthLabels = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"];
    
    // Assignments chart
    assignmentsChart = new Chart(document.getElementById('assignmentsChart'), {
      type: 'line',
      data: {
        labels: monthLabels,
        datasets: [{
          label: "Performance",
          data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
          borderColor: "#8e44ad",
          backgroundColor: "#8e44ad33",
          fill: true,
          tension: 0.3,
          pointBackgroundColor: "#8e44ad",
          pointBorderColor: "#fff",
          pointBorderWidth: 2,
          pointRadius: 4
        }]
      },
      options: { 
        plugins: { legend: { display: false } }, 
        scales: { 
          y: { 
            beginAtZero: true, 
            max: 100,
            grid: {
              color: 'rgba(0,0,0,0.05)'
            }
          },
          x: {
            grid: {
              color: 'rgba(0,0,0,0.05)'
            },
            ticks: {
              maxRotation: 0,
              callback: function(value, index, values) {
                // Show all month labels
                return monthLabels[index];
              }
            }
          }
        } 
      }
    });

    // Tests chart
    testsChart = new Chart(document.getElementById('testsChart'), {
      type: 'line',
      data: {
        labels: monthLabels,
        datasets: [{
          label: "Performance",
          data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
          borderColor: "#8e44ad",
          backgroundColor: "#8e44ad33",
          fill: true,
          tension: 0.3,
          pointBackgroundColor: "#8e44ad",
          pointBorderColor: "#fff",
          pointBorderWidth: 2,
          pointRadius: 4
        }]
      },
      options: { 
        plugins: { legend: { display: false } }, 
        scales: { 
          y: { 
            beginAtZero: true, 
            max: 100,
            grid: {
              color: 'rgba(0,0,0,0.05)'
            }
          },
          x: {
            grid: {
              color: 'rgba(0,0,0,0.05)'
            },
            ticks: {
              maxRotation: 0,
              callback: function(value, index, values) {
                // Show all month labels
                return monthLabels[index];
              }
            }
          }
        } 
      }
    });

    // Circular overall grade chart
    overallGradeChart = new Chart(document.getElementById('overallGradeChart'), {
      type: 'doughnut',
      data: {
        labels: ["Grade","Remaining"],
        datasets: [{
          data: [0, 100],
          backgroundColor: ["#8e44ad","#eee"],
          borderWidth: 1,
          borderColor: "#fff",
          cutout: "75%"
        }]
      },
      options: { 
        plugins: { legend: { display: false } },
        elements: {
          arc: {
            borderWidth: 1,
            borderColor: '#fff'
          }
        }
      }
    });
  }

  // Function to update charts with data from database
  function updateCharts(studentId) {
    // This is where you would fetch data from your database
    // For demonstration, we'll simulate fetching data
    fetchStudentData(studentId).then(studentData => {
      // Update assignments chart
      assignmentsChart.data.datasets[0].data = studentData.assignments;
      assignmentsChart.update();
      
      // Update tests chart
      testsChart.data.datasets[0].data = studentData.tests;
      testsChart.update();
      
      // Update overall grade chart
      const overallGrade = studentData.overallGrade;
      overallGradeChart.data.datasets[0].data = [overallGrade, 100 - overallGrade];
      overallGradeChart.update();
      
      // Update grade text
      document.getElementById('gradeText').textContent = `${overallGrade}%`;
    });
  }

  // Function to load test data from database
  function loadTestData(studentId) {
    const contentDiv = document.getElementById('tests');
    
    // Show loading state
    contentDiv.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading test data from database...</p>
      </div>
    `;
    
    // Simulate database call
    setTimeout(() => {
      // In a real application, you would fetch this from your database
      // This is where your database data will be displayed
      
      // Create empty table with correct structure
      let tableHTML = `
        <table>
          <thead>
            <tr>
              <th>Test Name</th>
              <th>Date</th>
              <th>Status</th>
              <th>AI Grade</th>
              <th>Updated Grade</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" style="text-align: center; padding: 20px;">
                Test data will be loaded from your database
              </td>
            </tr>
          </tbody>
        </table>
      `;
      
      contentDiv.innerHTML = tableHTML;
    }, 800);
  }

  // Simulate fetching student data from database
  function fetchStudentData(studentId) {
    return new Promise((resolve) => {
      // In a real application, you would fetch this from your database
      // This is sample data structure that would come from your database
      setTimeout(() => {
        // Sample data - replace with your actual database data
        const studentData = {
          assignments: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], // 11 months up to November
          tests: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], // 11 months up to November
          overallGrade: 0 // Will be populated from database
        };
        
        resolve(studentData);
      }, 500);
    });
  }

  // Tabs inside students
  document.querySelectorAll(".tab-btn").forEach(tab => {
    tab.addEventListener("click", () => {
      document.querySelectorAll(".tab-btn").forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      let tabName = tab.dataset.tab;
      document.querySelectorAll(".tab-content").forEach(c => c.style.display = "none");
      document.getElementById(tabName).style.display = "block";
      
      // Load data from database for active student
      const activeStudent = document.querySelector(".student-item-small.active");
      if (activeStudent) {
        loadTabData(tabName, activeStudent.dataset.studentId);
      }
    });
  });

  // Function to load data from database
  function loadTabData(tabName, studentId) {
    const contentDiv = document.getElementById(tabName);
    
    if (tabName === "grades") {
      // For grades tab, update charts with data from database
      updateCharts(studentId);
      return;
    } else if (tabName === "tests") {
      // For tests tab, load test data
      loadTestData(studentId);
      return;
    }
    
    contentDiv.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading ${tabName} data from database...</p>
      </div>
    `;
    
    // This is where you would make your actual database call
    // For demonstration, we'll simulate a database call with setTimeout
    setTimeout(() => {
      // In a real application, you would fetch data from your database
      // and populate the table based on the studentId and tabName
      
      // Example structure for database response
      let tableHTML = `
        <table>
          <thead>
            <tr>
      `;
      
      if (tabName === "assignments") {
        tableHTML += `
          <th>Assignment</th>
          <th>Due Date</th>
          <th>Status</th>
          <th>AI Grade</th>
          <th>Updated</th>
        </tr>
        </thead>
        <tbody>
          <tr><td colspan="5" style="text-align: center;">Data will be loaded from your database</td></tr>
        `;
      }
      
      tableHTML += `</tbody></table>`;
      contentDiv.innerHTML = tableHTML;
    }, 800);
  }

  // Function to load students from database for students page
  function loadStudentsFromDatabase() {
    const studentList = document.getElementById("studentList");
    studentList.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading students from database...</p>
      </div>
    `;
    
    // Simulate database call
    setTimeout(() => {
      // In a real application, you would fetch this from your database
      // This is sample data that would come from your database
      const students = [
        { id: 1, name: "Vixen", studentNumber: "213245" },
        { id: 2, name: "Spider-Man", studentNumber: "402189" },
        { id: 3, name: "Bat-Girl", studentNumber: "401267" },
        { id: 4, name: "Flash", studentNumber: "321956" },
        { id: 5, name: "Wonder Woman", studentNumber: "567812" },
        { id: 6, name: "Superman", studentNumber: "901234" }
      ];
      
      let studentsHTML = "";
      students.forEach((student, index) => {
        studentsHTML += `
          <div class="student-item-small ${index === 0 ? 'active' : ''}" 
               data-student-id="${student.id}">
            ${student.name} <span>${student.studentNumber.substring(0, 4)}...</span>
          </div>
        `;
      });
      
      studentList.innerHTML = studentsHTML;
      
      // Add event listeners to student items
      document.querySelectorAll(".student-item-small").forEach(stu => {
        stu.addEventListener("click", function() {
          document.querySelectorAll(".student-item-small").forEach(s => s.classList.remove("active"));
          this.classList.add("active");
          
          // Load data for the selected student
          const studentId = this.dataset.studentId;
          const activeTab = document.querySelector(".tab-btn.active").dataset.tab;
          loadTabData(activeTab, studentId);
        });
      });
    }, 1000);
  }

  // Function to load students from database for feedback page
  function loadFeedbackStudents() {
    const studentList = document.querySelector("#feedback-page .students");
    studentList.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading students from database...</p>
      </div>
    `;
    
    // Simulate database call
    setTimeout(() => {
      // In a real application, you would fetch this from your database
      // This is sample data that would come from your database
      const students = [
        { id: 1, name: "Vixen", studentNumber: "213245" },
        { id: 2, name: "Spider-Man", studentNumber: "402189" },
        { id: 3, name: "Bat-Girl", studentNumber: "401267" },
        { id: 4, name: "Flash", studentNumber: "321956" },
        { id: 5, name: "Wonder Woman", studentNumber: "567812" },
        { id: 6, name: "Superman", studentNumber: "901234" }
      ];
      
      let studentsHTML = "";
      students.forEach((student, index) => {
        studentsHTML += `
          <div class="student-item ${index === 0 ? 'active' : ''}" 
               data-student-id="${student.id}">
            <img src="https://placehold.co/40x40/9b59b6/FFFFFF?text=${student.name.charAt(0)}" alt="${student.name}">
            <div class="student-info">
              <h4>${student.name}</h4>
              <small>${student.studentNumber}</small>
            </div>
          </div>
        `;
      });
      
      studentList.innerHTML = studentsHTML;
      
      // Add event listeners to student items
      document.querySelectorAll("#feedback-page .student-item").forEach(stu => {
        stu.addEventListener("click", function() {
          document.querySelectorAll("#feedback-page .student-item").forEach(s => s.classList.remove("active"));
          this.classList.add("active");
          
          // Update student profile
          const studentName = this.querySelector("h4").textContent;
          const studentNumber = this.querySelector("small").textContent;
          document.getElementById("student-name").textContent = studentName;
          document.getElementById("student-number").textContent = `Student Number: ${studentNumber}`;
          document.getElementById("student-profile-img").src = `https://placehold.co/80x80/9b59b6/FFFFFF?text=${studentName.charAt(0)}`;
          
          // Load tasks for the selected student
          loadStudentTasks(this.dataset.studentId);
        });
      });
      
      // Load tasks for the first student by default
      if (students.length > 0) {
        loadStudentTasks(students[0].id);
      }
    }, 1000);
  }

  // Function to load tasks for a student in feedback page
  function loadStudentTasks(studentId) {
    const taskList = document.querySelector("#feedback-page .task-list");
    const autograderResults = document.querySelector("#feedback-page .autograder-results");
    
    // Show loading state
    taskList.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading tasks from database...</p>
      </div>
    `;
    
    autograderResults.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Select a task to view results</p>
      </div>
    `;
    
    // Simulate database call
    setTimeout(() => {
      // In a real application, you would fetch this from your database
      // This is sample data that would come from your database
      const tasks = [
        { id: 1, name: "Math Assignment 1", status: "completed", grade: "85%" },
        { id: 2, name: "Science Project", status: "pending", grade: "Not graded" },
        { id: 3, name: "History Essay", status: "completed", grade: "92%" },
        { id: 4, name: "English Test", status: "missing", grade: "0%" }
      ];
      
      let tasksHTML = "";
      tasks.forEach((task, index) => {
        const statusClass = task.status === "completed" ? "status-completed" : 
                           task.status === "pending" ? "status-pending" : "status-missing";
        
        tasksHTML += `
          <div class="task-item ${index === 0 ? 'active' : ''}" data-task-id="${task.id}">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
              <div>
                <strong>${task.name}</strong>
                <div style="margin-top: 5px;">
                  <span class="status-badge ${statusClass}">${task.status}</span>
                  <span style="margin-left: 10px; font-size: 12px;">Grade: ${task.grade}</span>
                </div>
              </div>
              <i class="fas fa-chevron-right"></i>
            </div>
          </div>
        `;
      });
      
      taskList.innerHTML = tasksHTML;
      
      // Add event listeners to task items
      document.querySelectorAll("#feedback-page .task-item").forEach(task => {
        task.addEventListener("click", function() {
          document.querySelectorAll("#feedback-page .task-item").forEach(t => t.classList.remove("active"));
          this.classList.add("active");
          
          // Load autograder results for the selected task
          loadAutograderResults(this.dataset.taskId);
        });
      });
      
      // Load autograder results for the first task by default
      if (tasks.length > 0) {
        loadAutograderResults(tasks[0].id);
      }
    }, 800);
  }

  // Function to load autograder results for a task
  function loadAutograderResults(taskId) {
    const autograderResults = document.querySelector("#feedback-page .autograder-results");
    
    // Show loading state
    autograderResults.innerHTML = `
      <div class="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading autograder results from database...</p>
      </div>
    `;
    
    // Simulate database call
    setTimeout(() => {
      // In a real application, you would fetch this from your database
      // This is sample data that would come from your database
      const results = [
        { id: 1, name: "Code compiles without errors", status: "passed", time: "2.3s" },
        { id: 2, name: "All test cases pass", status: "passed", time: "5.1s" },
        { id: 3, name: "Code follows style guidelines", status: "failed", time: "1.2s" },
        { id: 4, name: "No syntax errors", status: "passed", time: "0.8s" },
        { id: 5, name: "Memory usage within limits", status: "passed", time: "3.4s" }
      ];
      
      let resultsHTML = "";
      results.forEach(result => {
        resultsHTML += `
          <div class="result-item">
            <i class="fas fa-${result.status === 'passed' ? 'check' : 'xmark'}-circle"></i>
            <span>${result.name}</span>
            <small>${result.time}</small>
          </div>
        `;
      });
      
      autograderResults.innerHTML = resultsHTML;
    }, 600);
  }

  // Search functionality for students page
  document.getElementById("studentNumberSearch").addEventListener("input", filterStudents);
  document.getElementById("studentNameSearch").addEventListener("input", filterStudents);

  function filterStudents() {
    const numberSearch = document.getElementById("studentNumberSearch").value.toLowerCase();
    const nameSearch = document.getElementById("studentNameSearch").value.toLowerCase();
    
    document.querySelectorAll(".student-item-small").forEach(student => {
      const studentNumber = student.querySelector("span").textContent.toLowerCase();
      const studentName = student.textContent.split(" ")[0].toLowerCase();
      
      const numberMatch = studentNumber.includes(numberSearch);
      const nameMatch = studentName.includes(nameSearch);
      
      student.style.display = (numberMatch && nameMatch) ? "flex" : "none";
    });
  }

  // Search functionality for feedback page
  document.getElementById("studentNumberSearchFeedback").addEventListener("input", filterStudentsFeedback);
  document.getElementById("studentNameSearchFeedback").addEventListener("input", filterStudentsFeedback);

  function filterStudentsFeedback() {
    const numberSearch = document.getElementById("studentNumberSearchFeedback").value.toLowerCase();
    const nameSearch = document.getElementById("studentNameSearchFeedback").value.toLowerCase();
    
    document.querySelectorAll("#feedback-page .student-item").forEach(student => {
      const studentNumber = student.querySelector("small").textContent.toLowerCase();
      const studentName = student.querySelector("h4").textContent.toLowerCase();
      
      const numberMatch = studentNumber.includes(numberSearch);
      const nameMatch = studentName.includes(nameSearch);
      
      student.style.display = (numberMatch && nameMatch) ? "flex" : "none";
    });
  }

  // Practice page functionality
  // Add question functionality
  document.getElementById('add-question-btn').addEventListener('click', function() {
    const questionsList = document.querySelector('.questions-list');
    const questionCount = questionsList.children.length + 1;
    
    const newQuestion = document.createElement('div');
    newQuestion.className = 'question-item';
    newQuestion.innerHTML = `
      <div class="question-title">
        <h3>QUESTION ${questionCount}</h3>
        <button class="delete-question" style="margin-left: auto; background: #ff6b6b; color: white; border: none; border-radius: 4px; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="question-content">
        <textarea placeholder="Enter question content"></textarea>
      </div>
    `;
    
    // Add delete functionality to the new button
    newQuestion.querySelector('.delete-question').addEventListener('click', function() {
      newQuestion.remove();
      // Renumber remaining questions
      const questions = document.querySelectorAll('.question-title h3');
      questions.forEach((question, index) => {
        question.textContent = `QUESTION ${index + 1}`;
      });
    });
    
    questionsList.appendChild(newQuestion);
  });

  // Save test functionality
  document.getElementById('save-test-btn').addEventListener('click', function() {
    const testName = document.getElementById('test-name').value;
    const testDescription = document.getElementById('test-description').value;
    
    if (!testName) {
      alert('Please enter a test name');
      return;
    }
    
    // Simulate saving
    this.textContent = 'SAVING...';
    this.disabled = true;
    
    setTimeout(() => {
      this.textContent = 'SAVED!';
      this.style.background = '#2e7d32';
      
      setTimeout(() => {
        this.textContent = 'SAVE TEST';
        this.disabled = false;
        this.style.background = '#8e44ad';
      }, 2000);
    }, 1500);
  });

  // AI Test Generation Modal functionality
  const aiTestModal = document.getElementById('ai-test-modal');
  const aiTestBtn = document.getElementById('ai-test-btn');
  const closeModalBtn = document.getElementById('close-modal');
  const generateTestBtn = document.getElementById('generate-test-btn');

  // Open modal
  aiTestBtn.addEventListener('click', function() {
    aiTestModal.classList.add('active');
  });

  // Close modal
  closeModalBtn.addEventListener('click', function() {
    aiTestModal.classList.remove('active');
  });

  // Close modal when clicking outside
  aiTestModal.addEventListener('click', function(e) {
    if (e.target === aiTestModal) {
      aiTestModal.classList.remove('active');
    }
  });

  // Generate test functionality
  generateTestBtn.addEventListener('click', function() {
    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> GENERATING...';
    this.disabled = true;
    
    setTimeout(() => {
      // Get selected options
      const difficulty = document.querySelector('input[name="difficulty"]:checked').value;
      const questionTypes = Array.from(document.querySelectorAll('input[name="question-types"]:checked'))
        .map(input => input.value);
      const questionCount = document.getElementById('question-count').value;
      
      // Apply to the main form
      document.getElementById('test-name').value = `AI Generated ${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} Test`;
      document.getElementById('test-description').value = `This test was automatically generated by our AI system with ${questionCount} ${difficulty}-level questions including ${questionTypes.join(', ')} type questions.`;
      
      // Clear existing questions
      const questionsList = document.querySelector('.questions-list');
      questionsList.innerHTML = '';
      
      // Add AI generated questions
      for (let i = 1; i <= questionCount; i++) {
        const newQuestion = document.createElement('div');
        newQuestion.className = 'question-item';
        newQuestion.innerHTML = `
          <div class="question-title">
            <h3>QUESTION ${i}</h3>
          </div>
          <div class="question-content">
            <textarea placeholder="Enter question content">This is an AI-generated ${difficulty} difficulty question.</textarea>
          </div>
        `;
        questionsList.appendChild(newQuestion);
      }
      
      // Close modal and reset button
      aiTestModal.classList.remove('active');
      this.innerHTML = 'GENERATE TEST';
      this.disabled = false;
      
      alert('Test successfully generated with AI!');
    }, 2000);
  });

  // Test item selection
  const testItems = document.querySelectorAll('.test-item');
  testItems.forEach(item => {
    item.addEventListener('click', function() {
      testItems.forEach(i => i.classList.remove('active'));
      this.classList.add('active');
    });
  });

  // File upload functionality for tests
  const testDropZone = document.getElementById('test-drop-zone');
  const testFileInput = document.getElementById('test-file-input');
  const testUploadButton = document.getElementById('test-upload-button');

  testDropZone.addEventListener('click', () => {
    testFileInput.click();
  });

  testDropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    testDropZone.style.background = '#f0e6f5';
  });

  testDropZone.addEventListener('dragleave', () => {
    testDropZone.style.background = '#f8f9fa';
  });

  testDropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    testDropZone.style.background = '#f8f9fa';
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleTestFileUpload(files[0]);
    }
  });

  testFileInput.addEventListener('change', () => {
    if (testFileInput.files.length > 0) {
      handleTestFileUpload(testFileInput.files[0]);
    }
  });

  testUploadButton.addEventListener('click', () => {
    testFileInput.click();
  });

  function handleTestFileUpload(file) {
    alert(`Test file "${file.name}" uploaded successfully!`);
    // In a real implementation, this would send the file to the server
  }

  // File upload functionality for test reference materials
  const testReferenceDropZone = document.getElementById('test-reference-drop-zone');
  const testReferenceFileInput = document.getElementById('test-reference-file-input');
  const testReferenceUploadButton = document.getElementById('test-reference-upload-button');

  testReferenceDropZone.addEventListener('click', () => {
    testReferenceFileInput.click();
  });

  testReferenceDropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    testReferenceDropZone.style.background = '#f0e6f5';
  });

  testReferenceDropZone.addEventListener('dragleave', () => {
    testReferenceDropZone.style.background = '#f8f9fa';
  });

  testReferenceDropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    testReferenceDropZone.style.background = '#f8f9fa';
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleTestReferenceUpload(files[0]);
    }
  });

  testReferenceFileInput.addEventListener('change', () => {
    if (testReferenceFileInput.files.length > 0) {
      handleTestReferenceUpload(testReferenceFileInput.files[0]);
    }
  });

  testReferenceUploadButton.addEventListener('click', () => {
    testReferenceFileInput.click();
  });

  function handleTestReferenceUpload(file) {
    alert(`Test reference material "${file.name}" uploaded successfully! The AI will use this when marking tests.`);
    // In a real implementation, this would send the file to the server
  }

  // File upload functionality for assignments
  const assignmentDropZone = document.getElementById('assignment-drop-zone');
  const assignmentFileInput = document.getElementById('assignment-file-input');
  const assignmentUploadButton = document.getElementById('assignment-upload-button');

  assignmentDropZone.addEventListener('click', () => {
    assignmentFileInput.click();
  });

  assignmentDropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    assignmentDropZone.style.background = '#f0e6f5';
  });

  assignmentDropZone.addEventListener('dragleave', () => {
    assignmentDropZone.style.background = '#f8f9fa';
  });

  assignmentDropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    assignmentDropZone.style.background = '#f8f9fa';
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleAssignmentFileUpload(files[0]);
    }
  });

  assignmentFileInput.addEventListener('change', () => {
    if (assignmentFileInput.files.length > 0) {
      handleAssignmentFileUpload(assignmentFileInput.files[0]);
    }
  });

  assignmentUploadButton.addEventListener('click', () => {
    assignmentFileInput.click();
  });

  function handleAssignmentFileUpload(file) {
    alert(`Assignment file "${file.name}" uploaded successfully!`);
    // In a real implementation, this would send the file to the server
  }

  // File upload functionality for assignment reference materials
  const assignmentReferenceDropZone = document.getElementById('assignment-reference-drop-zone');
  const assignmentReferenceFileInput = document.getElementById('assignment-reference-file-input');
  const assignmentReferenceUploadButton = document.getElementById('assignment-reference-upload-button');

  assignmentReferenceDropZone.addEventListener('click', () => {
    assignmentReferenceFileInput.click();
  });

  assignmentReferenceDropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    assignmentReferenceDropZone.style.background = '#f0e6f5';
  });

  assignmentReferenceDropZone.addEventListener('dragleave', () => {
    assignmentReferenceDropZone.style.background = '#f8f9fa';
  });

  assignmentReferenceDropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    assignmentReferenceDropZone.style.background = '#f8f9fa';
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleAssignmentReferenceUpload(files[0]);
    }
  });

  assignmentReferenceFileInput.addEventListener('change', () => {
    if (assignmentReferenceFileInput.files.length > 0) {
      handleAssignmentReferenceUpload(assignmentReferenceFileInput.files[0]);
    }
  });

  assignmentReferenceUploadButton.addEventListener('click', () => {
    assignmentReferenceFileInput.click();
  });

  function handleAssignmentReferenceUpload(file) {
    alert(`Assignment reference material "${file.name}" uploaded successfully! The AI will use this when marking assignments.`);
    // In a real implementation, this would send the file to the server
  }

  // Save feedback functionality
  function saveFeedback() {
    const saveButton = document.getElementById('save-feedback-btn');
    const privateFeedback = document.getElementById('private-feedback-input').value;
    const classFeedback = document.getElementById('class-feedback-input').value;
    const adjustedGrade = document.getElementById('adjusted-grade').value;
    
    // Simulate saving
    saveButton.textContent = 'SAVING...';
    saveButton.disabled = true;
    
    setTimeout(() => {
      saveButton.textContent = 'SAVED!';
      saveButton.classList.add('saved');
      
      setTimeout(() => {
        saveButton.textContent = 'SAVE FEEDBACK';
        saveButton.disabled = false;
        saveButton.classList.remove('saved');
      }, 2000);
      
      alert('Feedback saved successfully!');
    }, 1500);
  }

  // Initialize the dashboard with data from your database
  document.addEventListener('DOMContentLoaded', async () => {
    // Show loading state
    document.getElementById('class-average').textContent = 'Loading...';
    document.getElementById('students-count').textContent = 'Fetching data from database...';
    
    // Fetch data from your database
    const students = await fetchStudentData();
    const subjects = await fetchSubjects();
    
    // Update the display with the fetched data
    updateClassAverage(students, null);
    renderSubjects(subjects);
    
    // Initialize charts
    initCharts();
  });
</script>
</body>
</html>
