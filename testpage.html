<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Student Test Interface</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 30px auto;
      background-color: #ffffff;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 15px;
    }

    .test-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #007BFF;
    }

    .instructions {
      font-size: 16px;
      color: #555;
      margin-bottom: 30px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
    }

    .question {
      margin-bottom: 35px;
      padding: 20px;
      border-radius: 8px;
      background-color: #fff;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
      border-left: 4px solid #8e44ad;
    }

    .question h3 {
      margin-bottom: 15px;
      color: #333;
      display: flex;
      align-items: flex-start;
    }

    .question-number {
      background-color: #8e44ad;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-right: 10px;
      font-size: 14px;
      flex-shrink: 0;
    }

    .question-type {
      display: inline-block;
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 4px;
      background-color: #e9ecef;
      color: #6c757d;
      margin-left: 10px;
      vertical-align: middle;
    }

    .options label {
      display: block;
      margin-bottom: 10px;
      cursor: pointer;
      padding: 10px;
      border-radius: 6px;
      transition: background-color 0.2s;
    }

    .options label:hover {
      background-color: #f8f9fa;
    }

    input[type="radio"] {
      margin-right: 10px;
      transform: scale(1.2);
    }

    .text-answer-container {
      margin-top: 15px;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 10px;
      padding: 8px;
      background-color: #f8f9fa;
      border-radius: 6px;
      border: 1px solid #e9ecef;
    }

    .toolbar button {
      background: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .toolbar button:hover {
      background-color: #e9ecef;
    }

    .toolbar button.active {
      background-color: #007BFF;
      color: white;
      border-color: #007BFF;
    }

    .text-editor {
      width: 100%;
      min-height: 150px;
      padding: 15px;
      font-size: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      resize: vertical;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.5;
    }

    .submit-btn {
      width: 100%;
      padding: 16px;
      background-color: #007BFF;
      color: white;
      font-size: 17px;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-top: 20px;
    }

    .submit-btn:hover {
      background-color: #0056b3;
    }

    .navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
    }

    .nav-btn {
      padding: 12px 25px;
      background-color: #6c757d;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
      transition: background-color 0.3s;
    }

    .nav-btn:hover {
      background-color: #5a6268;
    }

    .nav-btn.primary {
      background-color: #007BFF;
    }

    .nav-btn.primary:hover {
      background-color: #0056b3;
    }

    .page-indicator {
      text-align: center;
      margin: 15px 0;
      font-weight: bold;
      color: #6c757d;
    }

    .question-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
      justify-content: center;
    }

    .question-nav-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: white;
      border: 1px solid #ddd;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: bold;
    }

    .question-nav-btn:hover {
      background-color: #e9ecef;
    }

    .question-nav-btn.active {
      background-color: #007BFF;
      color: white;
      border-color: #007BFF;
    }

    .question-nav-btn.answered {
      background-color: #28a745;
      color: white;
      border-color: #28a745;
    }

    .timer {
      font-size: 18px;
      font-weight: bold;
      color: #dc3545;
      text-align: center;
      margin-bottom: 20px;
      padding: 10px;
      background-color: #f8f9fa;
      border-radius: 8px;
    }

    @media (max-width: 768px) {
      .container {
        margin: 15px;
        padding: 20px;
      }
      
      .test-info {
        flex-direction: column;
        gap: 10px;
      }
      
      .toolbar {
        justify-content: center;
      }
      
      .question-nav {
        gap: 5px;
      }
      
      .question-nav-btn {
        width: 35px;
        height: 35px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>

  <div class="container">
    <h1 id="test-title">Loading Test...</h1>
    
    <div class="test-info">
      <div><strong>Subject:</strong> <span id="test-subject">Loading...</span></div>
      <div><strong>Time Allowed:</strong> <span id="test-time">Loading...</span></div>
      <div><strong>Total Marks:</strong> <span id="test-marks">Loading...</span></div>
    </div>
    
    <div class="timer" id="timer">Time Remaining: --:--</div>
    
    <div class="instructions" id="instructions">
      <p><strong>Instructions:</strong></p>
      <div id="instructions-content">Loading instructions...</div>
    </div>

    <div class="page-indicator" id="page-indicator">Page 1 of 1</div>

    <div class="question-nav" id="question-nav"></div>

    <form id="test-form">
      <div id="questions-container">
        <!-- Questions will be dynamically inserted here -->
        <div class="loading">Loading questions...</div>
      </div>

      <div class="navigation">
        <button type="button" class="nav-btn" id="prev-btn">Previous Page</button>
        <button type="button" class="nav-btn primary" id="next-btn">Next Page</button>
      </div>

      <button type="submit" class="submit-btn">Submit Test</button>
    </form>
  </div>

  <script>
    // Sample test data - In a real application, this would come from the server
    const sampleTestData = {
      title: "IT Fundamentals Test",
      subject: "IT Fundamentals",
      timeAllowed: 60, // minutes
      totalMarks: 100,
      instructions: [
        "Answer all the questions below.",
        "Multiple-choice questions require selecting one answer.",
        "For theory questions, use the formatting toolbar to enhance your answers.",
        "You can navigate between questions using the Previous/Next buttons or the question navigation bar.",
        "Submit your test before the time expires."
      ],
      questions: [
        {
          id: 1,
          type: "multiple_choice",
          text: "Which of the following is NOT a phase in the SDLC?",
          marks: 5,
          options: [
            { id: "a", text: "Requirement Analysis" },
            { id: "b", text: "Design" },
            { id: "c", text: "Deployment" },
            { id: "d", text: "Hacking" }
          ]
        },
        {
          id: 2,
          type: "multiple_choice",
          text: "What does HTTP stand for?",
          marks: 5,
          options: [
            { id: "a", text: "HyperText Transfer Protocol" },
            { id: "b", text: "HighText Transfer Protocol" },
            { id: "c", text: "HyperText Transmission Protocol" },
            { id: "d", text: "Hyper Tool Transfer Protocol" }
          ]
        },
        {
          id: 3,
          type: "multiple_choice",
          text: "Which of these is considered a type of cyber attack?",
          marks: 5,
          options: [
            { id: "a", text: "Phishing" },
            { id: "b", text: "Debugging" },
            { id: "c", text: "Compiling" },
            { id: "d", text: "Programming" }
          ]
        },
        {
          id: 4,
          type: "multiple_choice",
          text: "What is the main purpose of a firewall?",
          marks: 5,
          options: [
            { id: "a", text: "Speed up the internet" },
            { id: "b", text: "Filter incoming and outgoing network traffic" },
            { id: "c", text: "Backup data" },
            { id: "d", text: "Store passwords" }
          ]
        },
        {
          id: 5,
          type: "multiple_choice",
          text: "Which one of the following is a database management system?",
          marks: 5,
          options: [
            { id: "a", text: "Oracle" },
            { id: "b", text: "Windows" },
            { id: "c", text: "Python" },
            { id: "d", text: "Ubuntu" }
          ]
        },
        {
          id: 6,
          type: "long_answer",
          text: "Explain the phases of the Software Development Life Cycle (SDLC).",
          marks: 15
        },
        {
          id: 7,
          type: "long_answer",
          text: "Describe three common types of cyber attacks and how to prevent them.",
          marks: 15
        },
        {
          id: 8,
          type: "long_answer",
          text: "What is the importance of data backup in IT infrastructure?",
          marks: 15
        },
        {
          id: 9,
          type: "long_answer",
          text: "Describe the difference between authentication and authorization.",
          marks: 15
        },
        {
          id: 10,
          type: "long_answer",
          text: "What role does encryption play in securing communication?",
          marks: 15
        }
      ]
    };

    document.addEventListener('DOMContentLoaded', function() {
      // Initialize variables
      let currentPage = 1;
      let questionsPerPage = 4;
      let testData = {};
      let totalPages = 1;
      let totalQuestions = 0;
      const timerElement = document.getElementById('timer');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const pageIndicator = document.getElementById('page-indicator');
      const questionNav = document.getElementById('question-nav');
      const questionsContainer = document.getElementById('questions-container');
      
      // Load test data (in a real app, this would be from an API)
      loadTestData();
      
      // Functions
      function loadTestData() {
        // In a real application, this would fetch data from the server
        // For now, we'll use the sample data
        testData = sampleTestData;
        totalQuestions = testData.questions.length;
        totalPages = Math.ceil(totalQuestions / questionsPerPage);
        
        // Update UI with test data
        document.getElementById('test-title').textContent = testData.title;
        document.getElementById('test-subject').textContent = testData.subject;
        document.getElementById('test-time').textContent = `${testData.timeAllowed} minutes`;
        document.getElementById('test-marks').textContent = testData.totalMarks;
        
        // Update instructions
        const instructionsContent = document.getElementById('instructions-content');
        instructionsContent.innerHTML = '';
        testData.instructions.forEach(instruction => {
          const li = document.createElement('li');
          li.textContent = instruction;
          instructionsContent.appendChild(li);
        });
        
        // Create question navigation buttons
        createQuestionNav();
        
        // Render questions
        renderQuestions();
        
        // Initialize timer
        initializeTimer();
        
        // Show first page
        showPage(currentPage);
      }
      
      function createQuestionNav() {
        questionNav.innerHTML = '';
        for (let i = 1; i <= totalQuestions; i++) {
          const btn = document.createElement('button');
          btn.className = 'question-nav-btn';
          btn.textContent = i;
          btn.dataset.question = i;
          btn.addEventListener('click', () => navigateToQuestion(i));
          questionNav.appendChild(btn);
        }
      }
      
      function renderQuestions() {
        questionsContainer.innerHTML = '';
        
        // Create pages
        for (let pageNum = 1; pageNum <= totalPages; pageNum++) {
          const pageDiv = document.createElement('div');
          pageDiv.className = 'page';
          pageDiv.id = `page${pageNum}`;
          
          // Calculate which questions belong to this page
          const startIndex = (pageNum - 1) * questionsPerPage;
          const endIndex = Math.min(startIndex + questionsPerPage, totalQuestions);
          
          // Add questions to this page
          for (let i = startIndex; i < endIndex; i++) {
            const question = testData.questions[i];
            const questionElement = createQuestionElement(question);
            pageDiv.appendChild(questionElement);
          }
          
          questionsContainer.appendChild(pageDiv);
        }
        
        // Set up formatting toolbars for long answer questions
        setupToolbars();
        
        // Track answered questions
        trackAnsweredQuestions();
      }
      
      function createQuestionElement(question) {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'question';
        questionDiv.id = `q${question.id}`;
        
        const questionHeader = document.createElement('h3');
        const questionNumber = document.createElement('span');
        questionNumber.className = 'question-number';
        questionNumber.textContent = question.id;
        
        const questionType = document.createElement('span');
        questionType.className = 'question-type';
        questionType.textContent = question.type === 'multiple_choice' ? 'Multiple Choice' : 'Long Answer';
        
        questionHeader.appendChild(questionNumber);
        questionHeader.appendChild(document.createTextNode(question.text));
        questionHeader.appendChild(questionType);
        
        questionDiv.appendChild(questionHeader);
        
        if (question.type === 'multiple_choice') {
          const optionsDiv = document.createElement('div');
          optionsDiv.className = 'options';
          
          question.options.forEach(option => {
            const label = document.createElement('label');
            const input = document.createElement('input');
            input.type = 'radio';
            input.name = `q${question.id}`;
            input.value = option.id;
            
            label.appendChild(input);
            label.appendChild(document.createTextNode(option.text));
            optionsDiv.appendChild(label);
          });
          
          questionDiv.appendChild(optionsDiv);
        } else if (question.type === 'long_answer') {
          const answerContainer = document.createElement('div');
          answerContainer.className = 'text-answer-container';
          
          const toolbar = document.createElement('div');
          toolbar.className = 'toolbar';
          toolbar.id = `toolbar${question.id}`;
          toolbar.innerHTML = `
            <button type="button" data-command="bold" title="Bold"><b>B</b></button>
            <button type="button" data-command="italic" title="Italic"><i>I</i></button>
            <button type="button" data-command="underline" title="Underline"><u>U</u></button>
            <button type="button" data-command="insertUnorderedList" title="Bullet List">• List</button>
            <button type="button" data-command="insertOrderedList" title="Numbered List">1. List</button>
          `;
          
          const editor = document.createElement('div');
          editor.className = 'text-editor';
          editor.id = `editor${question.id}`;
          editor.contentEditable = true;
          editor.dataset.question = `q${question.id}`;
          
          const hiddenInput = document.createElement('input');
          hiddenInput.type = 'hidden';
          hiddenInput.name = `q${question.id}`;
          hiddenInput.id = `hidden-q${question.id}`;
          
          answerContainer.appendChild(toolbar);
          answerContainer.appendChild(editor);
          answerContainer.appendChild(hiddenInput);
          
          questionDiv.appendChild(answerContainer);
        }
        
        return questionDiv;
      }
      
      function setupToolbars() {
        // Set up formatting for each long answer question
        testData.questions.forEach(question => {
          if (question.type === 'long_answer') {
            const toolbar = document.getElementById(`toolbar${question.id}`);
            const editor = document.getElementById(`editor${question.id}`);
            
            if (toolbar && editor) {
              toolbar.addEventListener('click', function(e) {
                if (e.target.tagName === 'BUTTON') {
                  e.preventDefault();
                  const command = e.target.dataset.command;
                  
                  // Focus on the editor first
                  editor.focus();
                  
                  // Execute the formatting command
                  document.execCommand(command, false, null);
                  
                  // Update the hidden field
                  updateHiddenField(question.id);
                }
              });
              
              // Update hidden field when editor content changes
              editor.addEventListener('input', function() {
                updateHiddenField(question.id);
                markQuestionAsAnswered(question.id);
              });
            }
          }
        });
      }
      
      function updateHiddenField(questionId) {
        const editor = document.getElementById(`editor${questionId}`);
        const hiddenField = document.getElementById(`hidden-q${questionId}`);
        if (editor && hiddenField) {
          hiddenField.value = editor.innerHTML;
        }
      }
      
      function trackAnsweredQuestions() {
        // Track radio button changes
        const radioInputs = document.querySelectorAll('input[type="radio"]');
        radioInputs.forEach(input => {
          input.addEventListener('change', function() {
            const questionId = this.name.substring(1); // Remove 'q' from name
            markQuestionAsAnswered(questionId);
          });
        });
      }
      
      function markQuestionAsAnswered(questionId) {
        const btn = document.querySelector(`.question-nav-btn[data-question="${questionId}"]`);
        if (btn) {
          btn.classList.add('answered');
        }
      }
      
      function initializeTimer() {
        let timeRemaining = testData.timeAllowed * 60; // Convert to seconds
        updateTimerDisplay(timeRemaining);
        
        const timerInterval = setInterval(() => {
          timeRemaining--;
          updateTimerDisplay(timeRemaining);
          
          if (timeRemaining <= 0) {
            clearInterval(timerInterval);
            alert('Time is up! Your test will be submitted automatically.');
            document.getElementById('test-form').submit();
          }
        }, 1000);
      }
      
      function updateTimerDisplay(timeRemaining) {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        timerElement.textContent = `Time Remaining: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        // Change color when time is running low
        if (timeRemaining < 300) { // 5 minutes
          timerElement.style.color = '#dc3545';
          timerElement.style.backgroundColor = '#ffe6e6';
        }
      }
      
      function showPage(pageNum) {
        // Hide all pages
        for (let i = 1; i <= totalPages; i++) {
          const page = document.getElementById(`page${i}`);
          if (page) {
            page.style.display = 'none';
          }
        }
        
        // Show the selected page
        const currentPageElement = document.getElementById(`page${pageNum}`);
        if (currentPageElement) {
          currentPageElement.style.display = 'block';
        }
        
        // Update navigation buttons
        prevBtn.disabled = pageNum === 1;
        nextBtn.disabled = pageNum === totalPages;
        
        // Update page indicator
        pageIndicator.textContent = `Page ${pageNum} of ${totalPages}`;
        
        // Update question navigation
        updateQuestionNav(pageNum);
        
        currentPage = pageNum;
      }
      
      function navigateToPage(pageNum) {
        if (pageNum >= 1 && pageNum <= totalPages) {
          showPage(pageNum);
        }
      }
      
      function navigateToQuestion(questionNum) {
        const pageNum = Math.ceil(questionNum / questionsPerPage);
        showPage(pageNum);
        
        // Scroll to the question
        const questionElement = document.getElementById(`q${questionNum}`);
        if (questionElement) {
          questionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
      
      function updateQuestionNav(currentPage) {
        const buttons = document.querySelectorAll('.question-nav-btn');
        buttons.forEach(btn => {
          btn.classList.remove('active');
          const questionNum = parseInt(btn.dataset.question);
          const pageNum = Math.ceil(questionNum / questionsPerPage);
          if (pageNum === currentPage) {
            btn.classList.add('active');
          }
        });
      }
      
      // Navigation event listeners
      prevBtn.addEventListener('click', () => navigateToPage(currentPage - 1));
      nextBtn.addEventListener('click', () => navigateToPage(currentPage + 1));
      
      // Form submission
      document.getElementById('test-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Save content from all editors to hidden fields
        testData.questions.forEach(question => {
          if (question.type === 'long_answer') {
            const editor = document.getElementById(`editor${question.id}`);
            const hiddenField = document.getElementById(`hidden-q${question.id}`);
            if (editor && hiddenField) {
              hiddenField.value = editor.innerHTML;
            }
          }
        });
        
        if (confirm('Are you sure you want to submit your test?')) {
          // In a real application, this would send the data to the server
          const formData = new FormData(this);
          const answers = {};
          
          for (let [key, value] of formData.entries()) {
            answers[key] = value;
          }
          
          console.log('Test submitted with answers:', answers);
          alert('Test submitted successfully!');
        }
      });
    });
  </script>
</body>
</html>

